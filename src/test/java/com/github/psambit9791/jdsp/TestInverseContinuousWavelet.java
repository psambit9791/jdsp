/*
 *
 *  * Copyright (c) 2020 Sambit Paul
 *  *
 *  * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *  *
 *  * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *  *
 *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 */

package com.github.psambit9791.jdsp;

import com.github.psambit9791.jdsp.misc.UtilMethods;
import com.github.psambit9791.jdsp.transform.InverseContinuousWavelet;
import org.apache.commons.math3.complex.Complex;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class TestInverseContinuousWavelet {

    private int[] widths = {1,  2,  3,  4,  5,  6,  7,  8,  9, 10};
    private double[] signal = {1.0003, -0.1876, -0.931 ,  0.5332,  0.7249, -0.8137, -0.4293,
            0.9693,  0.0711, -0.9737,  0.3371,  0.9089, -0.6114, -0.6335,
            0.8421,  0.2268, -1.1182, -0.0832,  0.8464, -0.4692, -0.7236,
            0.9668,  0.9045, -0.5044,  0.1777,  1.1745, -0.3053, -1.3719,
            -0.1669, -0.0787, -1.5103, -0.8144,  1.0282,  0.5865, -0.1208,
            1.309 ,  1.7476, -0.1137, -0.5778,  0.4877, -0.3923, -1.7997,
            -0.6399,  0.5264, -0.5437, -0.6345,  1.094 ,  0.9612, -0.5611,
            0.0504};

    @Test
    public void testRicker() {
        double[][] result = {
                {0.8146560965070269, 0.6726226336929975, -1.3092663917219374, -0.4462936495331019, 1.4176452957462529, -0.0927401961131534, -1.390214309169488, 0.602582691230861, 1.1516013352905003, -1.043558913778555, -0.7593179335572319, 1.3471802695954365, 0.29517728343957206, -1.3991107817893107, 0.2916573106853319, 1.3317522373476371, -0.7984822632320175, -1.113288408244606, 1.0574466006922731, 0.506424805329129, -1.4528873443552959, -0.08408009806769094, 1.5219045052950742, -0.24648000038402432, -1.0064895889447052, 1.138209404563409, 1.0363403374708482, -1.2943248505915086, -0.6677823087245359, 1.0499572523646676, -0.5047318029845917, -1.7214718531902191, 0.4631717500088269, 1.2609381692475041, -0.7068929198539867, -0.2920058273822629, 1.803916833310612, 0.6035584158920256, -1.326101363732516, 0.1222467968142887, 0.9933036506969412, -1.181195913609119, -1.4112499769029105, 0.9310702792723697, 0.5677166630545629, -1.2603574240763733, 0.1375594026988709, 1.6885101926172645, -0.03492423629056124, -0.8364536550650129},
                {0.4575991006457015, 0.15424309942489167, -0.20430218645567988, -0.1979332715201142, -0.03400840263854729, -0.06094941471641338, -0.10710861831812035, 0.01242399581007371, 0.05619799050757986, -0.03963114634770472, 0.008712434979646744, 0.15699650616377675, 0.1190281105955861, 0.015235202034745772, 0.05242368266386099, 0.009364123079106224, -0.23384675615953887, -0.367651317819394, -0.30521610035885816, -0.28347360518000697, -0.20743245687595938, 0.16230019930210737, 0.5884987747135192, 0.7672171412276161, 0.822834405565704, 0.7781893797573177, 0.34487069215453775, -0.3906726040896952, -0.9798066908397715, -1.32447335304021, -1.4952764031377532, -1.2242302862230938, -0.40614771951916967, 0.5113991397348042, 1.1971929194703024, 1.6897274423657713, 1.8040998684564218, 1.2686952562275804, 0.37021119897626353, -0.42475513114463087, -1.07606031287705, -1.5319640067769806, -1.4574195850665161, -0.8853176694843405, -0.259585382358008, 0.3053410492978635, 0.8894919190775901, 1.138003140795828, 0.7139967919063364, 0.002582130875423935},
                {0.2820739007337005, 0.19691375150387463, 0.05816965623302783, -0.06793260848734896, -0.1378499383579532, -0.1462691208876864, -0.1121788658188729, -0.05784653766500612, 0.002082524637502914, 0.0595278467417243, 0.1061754525791671, 0.12861945625143026, 0.11023321452625504, 0.03848015540013523, -0.08659034951139666, -0.24530282424485583, -0.3956330262427364, -0.47955631341339594, -0.4393465250157463, -0.2397853361409545, 0.11070001612485857, 0.5476465640304126, 0.9553692230474575, 1.1935907926409919, 1.1408097752471678, 0.7412479950786639, 0.03946020105783317, -0.8129192374466198, -1.5878256284804808, -2.0442472014884356, -2.0054491809278097, -1.4245032916006264, -0.4141979860020343, 0.7739778459836747, 1.8195674010134648, 2.429609646322717, 2.4298106894169496, 1.8200285963841258, 0.7751892253457219, -0.41008284585016525, -1.4132361975911385, -1.9796292762642052, -1.9930470372634665, -1.5024822481108693, -0.699379214015625, 0.14720446568861126, 0.7797829960664566, 1.0410904404464694, 0.928449284487429, 0.5803844985857854},
                {0.2238545256478071, 0.18264270142365313, 0.1095970640984425, 0.02704494628832471, -0.0415014707259668, -0.0794380368398928, -0.08137442887141723, -0.053170971846864395, -0.009175894407902618, 0.03187714790207999, 0.05123929691480858, 0.034183630916977556, -0.026048312676140193, -0.12429467052749771, -0.24090800559936718, -0.3426803481090395, -0.38847603839647504, -0.3396327027805086, -0.1737483675846454, 0.10193981414608838, 0.4430370383892212, 0.7708538377630969, 0.9873453081250476, 1.0010341134427665, 0.7574719169268503, 0.26478702769814494, -0.3953211531035584, -1.0778012632566207, -1.6064270610938145, -1.8210367165478984, -1.6265504900179037, -1.0281739444518867, -0.14036828817660976, 0.8365320701014247, 1.6669766987322996, 2.143958078586545, 2.1471754803064655, 1.6776901964788855, 0.8577013307860579, -0.10467744481882434, -0.9744837388331855, -1.5548180734369104, -1.7382036510044063, -1.5291334868569946, -1.0321283441826967, -0.41135543303723104, 0.16334155382819504, 0.5657146793417397, 0.7418163327853088, 0.7107643980843285},
                {0.19341316324209587, 0.173563866129205, 0.13638989055787698, 0.09057729617798502, 0.045641556598920274, 0.009244589160551153, -0.015083668483829547, -0.029029563270283693, -0.03870637410159142, -0.052349741512907236, -0.07730936779956363, -0.1168077606606032, -0.16722593002134284, -0.21717826034262003, -0.24902903852753172, -0.2426448452952975, -0.18105761398207088, -0.057191689998430426, 0.12040922350695103, 0.3251400726649608, 0.5145078339149233, 0.6374699786024867, 0.6464634596897285, 0.5115661617987008, 0.23265511505585126, -0.1543003413086455, -0.5794913382775598, -0.9517316471117068, -1.178450211393198, -1.1892847175152919, -0.9568115377055161, -0.5079447803972709, 0.07785079867384236, 0.6840505555589078, 1.1833536071021562, 1.4682181262592848, 1.4771752184739984, 1.2098029623193904, 0.7265075346085588, 0.1329861396816855, -0.44645694713795225, -0.898992028050299, -1.1484747276623295, -1.169738489165527, -0.9890340748030715, -0.6714794296174473, -0.30041472479605247, 0.044523247375677096, 0.30479283328996615, 0.45211836696893654},
                {0.18312100581999982, 0.17336882095972594, 0.15235640029061956, 0.12305186899100654, 0.08658656706041283, 0.04660845033605711, 0.007117762449897536, -0.03215298120997718, -0.0720127518238445, -0.10975083958593501, -0.14279623091876723, -0.16963819334681737, -0.1846252705313084, -0.17908712340215233, -0.14794325510133793, -0.08963834228598286, -0.0041930798642934725, 0.10139481916460545, 0.21009526505785397, 0.3011426870475994, 0.35430569023487984, 0.34947517982896925, 0.2729506021578784, 0.1267705115315254, -0.07166590502790043, -0.2940745422508328, -0.4991663735208789, -0.6461055420096928, -0.6975108270661555, -0.6301828688962621, -0.44563372399539924, -0.1684209489504719, 0.1596824340548272, 0.48270120290602686, 0.7405188189662959, 0.8859267933424915, 0.8936216831085037, 0.7610492517883325, 0.5112372784736788, 0.19111833117740035, -0.14230643418457256, -0.4357147031478424, -0.6451398925955599, -0.7431504450068847, -0.7269627436857892, -0.6150541893723693, -0.43693576926191197, -0.22862454117877073, -0.028022580110098345, 0.13595810183577772},
                {0.1751998788379473, 0.1593974432138551, 0.1404356399694436, 0.11990231196317158, 0.0851415875779564, 0.04399298996966325, 0.010994629191629801, -0.022484314758583104, -0.0631125490369166, -0.09468737525593447, -0.11063229333256167, -0.12261242456901499, -0.12535681913759947, -0.10253131373068808, -0.06159410868602355, -0.01686874082602627, 0.03743134392265886, 0.09968755062664299, 0.14519630334996256, 0.16208774465735443, 0.15733090196722657, 0.1229799149709913, 0.047010201800193246, -0.05394044360426491, -0.15656317000435502, -0.2567015218280406, -0.32745363553124435, -0.3662995570618182, -0.3567425123082528, -0.28240645662159436, -0.158965344179298, -0.009822067487603866, 0.15723938199706963, 0.32121633055159465, 0.4426773812525321, 0.5037108745446799, 0.5074176319154889, 0.44571513478483066, 0.31628572607932676, 0.1487696556714957, -0.02571374398950988, -0.19632097798014952, -0.34269875528847454, -0.4333823297604592, -0.4636718739747832, -0.4477888655807418, -0.385324180982337, -0.2797522008846159, -0.1605123984378456, -0.05014020831326094},
                {0.15809958555769119, 0.12144379494708343, 0.10185308791706416, 0.09956171571845518, 0.07071890329812172, 0.03651383128539859, 0.03488316985571982, 0.02948925551912855, -0.006657993836804772, -0.02950104635869744, -0.028677297225971343, -0.04880225868424669, -0.07703205889666291, -0.06569018004651306, -0.0389699856466018, -0.033108928883512176, -0.013928083889829218, 0.03229373364655948, 0.05212563491458558, 0.03648429729399691, 0.02923486832076734, 0.015717489905323373, -0.0420895804888287, -0.10698266023706478, -0.14000208304577355, -0.17411861269658072, -0.17329069163301009, -0.17635938173204377, -0.16633859964902692, -0.10248811801347663, -0.019771855813219802, 0.04372561599217308, 0.11997809300551154, 0.21310020064954083, 0.2658097347097442, 0.2732962448902514, 0.2773214687403561, 0.257155136855607, 0.17784773840323367, 0.0814102593188349, 0.0032529649748205165, -0.0898895005874505, -0.19608517464525263, -0.25830252767789247, -0.27884255002237285, -0.2989345685491406, -0.29369849580188606, -0.2326484797922601, -0.16163659091541474, -0.1100926132163384},
                {0.1334837957224408, 0.0688137854392287, 0.05299472671921737, 0.08154153451039695, 0.06337376526253574, 0.04055916493910572, 0.08359724759542785, 0.11202641639354374, 0.07008262004765022, 0.04550279517924151, 0.054284679756376776, 0.005446991922180254, -0.07085035105454585, -0.07709158258338798, -0.06195116819047078, -0.09220132766482453, -0.09106562742876576, -0.027696717137647875, -0.005353847152175004, -0.03413575318245482, -0.022581456435743302, -0.0037864808122034105, -0.05704084904201949, -0.11167585911789185, -0.10159881470334703, -0.10725458281865605, -0.06523463572412991, -0.06427488293672268, -0.07791420709429961, -0.021243158737554294, 0.04385141707937221, 0.049231595404758556, 0.07368243647728961, 0.14592611851586598, 0.16640721982156365, 0.1348077052156659, 0.14404682373717514, 0.15582764484556103, 0.09118745752311903, 0.021118424771675436, 0.004341358931037868, -0.042986649588756726, -0.1368971559537328, -0.1750467436645376, -0.16719176424713558, -0.20083504440781502, -0.22529730013673915, -0.1686886478916386, -0.1112352713644188, -0.1036651099114175},
                {0.10775715158223381, 0.01624902920685889, 0.008983394385080667, 0.07343458004562312, 0.06696461258764519, 0.05524455332296935, 0.1423814647012246, 0.19906470814006466, 0.1411809086447376, 0.1061094291228552, 0.11588002224907357, 0.031236269516579034, -0.09556891225448572, -0.11339391051354496, -0.09964312047195505, -0.1541586562756242, -0.1550595100299219, -0.057372624318070484, -0.021232342176756278, -0.057819138018978436, -0.02575697379643771, 0.019618786790021894, -0.04390896886958062, -0.1061749207361061, -0.07078062273719761, -0.06742329726903291, 0.0017911976271276827, -0.0032491633859162705, -0.04555010355772936, 0.009494245825979013, 0.07184724274528227, 0.03712344193832709, 0.030364313528213255, 0.1048376850298388, 0.11154567407739771, 0.04972778167880153, 0.06621630524328946, 0.10531286954172316, 0.04065141776023148, -0.02404302475070961, 5.819418379842244E-4, -0.019352787313046627, -0.11787611596982839, -0.14117456321549707, -0.10388949898048358, -0.1445759548007503, -0.18789881430938596, -0.11819952655775447, -0.05456738752558251, -0.07556578199020457}
        };
        double[][][] res3D = new double[result.length][result[0].length][2];
        for (int i=0; i<res3D.length; i++) {
            for (int j=0; j<res3D[0].length; j++) {
                res3D[i][j][0] = result[i][j];
                res3D[i][j][1] = 0;
            }
        }
        Complex[][] cplx_res = UtilMethods.matToComplex(res3D);
        InverseContinuousWavelet icwt = new InverseContinuousWavelet(cplx_res, this.widths);
        double[] out = icwt.transform(InverseContinuousWavelet.waveletType.RICKER, 0);
        Assertions.assertArrayEquals(this.signal, out, 0.1);
    }

    @Test
    public void testMorlet() {
        double[][][] result = {
                {{ -0.5775518900038782, -0.3550873756995372}, { -0.4924404513057653, 0.6865181778503489}, { 0.7472466712296031, 0.40203027575698314}, { 0.26263366013606443, -0.7942238928132551}, { -0.8351981511713985, -0.103457077555758}, { 0.05715833891416557, 0.8350763511821373}, { 0.822513276497443, -0.2094693053020043}, { -0.3574169278125677, -0.7612247705886112}, { -0.686202080239435, 0.48364281836720036}, { 0.6050314950371711, 0.5623194129772447}, { 0.43230658020813423, -0.7154009596048523}, { -0.8135368522249546, -0.311444414167874}, { -0.187264120321794, 0.8293176490987259}, { 0.8269299009229638, 0.023571448280545897}, { -0.15008418355440065, -0.7821908085065364}, { -0.737945582143462, 0.3560060222643624}, { 0.5441437261892228, 0.7486630378206058}, { 0.7405014015451115, -0.5553076551126649}, { -0.5551930950101363, -0.519085920700648}, { -0.2730966103478268, 0.6740200779404878}, { 0.813154147768214, 0.07652749328081924}, { -0.0810617531337828, -0.9873122560573085}, { -1.106416727159254, -0.023485433107761335}, { -0.1011479071676182, 0.7438003318442217}, { 0.3702734469555674, -0.33617151674994183}, { -0.801611557008612, -0.44776905236104925}, { -0.5843270639055839, 0.9406219713027651}, { 0.9783807908889885, 0.7277547489392989}, { 0.7734209612200826, -0.5373075327398786}, { -0.14929949080525232, -0.004675342558643182}, { 0.7496476233417051, 0.7226957323029339}, { 1.3280464874130449, -0.5255776500371849}, { -0.19779377150714075, -1.2082656188817684}, { -0.9425585988750882, 0.025673460959126503}, { -0.019588451086286245, 0.22420082374263714}, { -0.4040573023707709, -0.8348872782861558}, { -1.6421671927086663, -0.1790282634281141}, { -0.7937044702927488, 1.1696903857681598}, { 0.5856640135569523, 0.46586276058069614}, { 0.0035911348568329997, -0.3698441978225249}, { -0.2756450393689088, 0.625457710311269}, { 1.1492393105886347, 0.8179402234649127}, { 1.3045799979445019, -0.6725707869356661}, { -0.17106200605061447, -0.7495069121299485}, { -0.12156745304674714, 0.43176874870419235}, { 0.772392384419264, -0.08831300049236335}, { -0.21003504232231907, -1.031179501543415}, { -1.2085156645919757, 0.03635935146474009}, { -0.13684245889895685, 0.8448680484676606}, { 0.38826700190787317, -0.024094819490449497}},
                {{ -0.04456795278369258, -0.5392256912719777}, { 0.48998337522743995, 0.29219830541588}, { -0.4376697089993637, 0.2919938032887843}, { -0.14447446889634563, -0.45256894153208577}, { 0.4475754476913594, -0.05213883643715064}, { -0.029371916676434004, 0.4446183883824975}, { -0.43001985927982284, -0.11088233001724407}, { 0.1890713226399804, -0.4023906532140035}, { 0.35919307276660334, 0.26142653093343715}, { -0.32367125331128277, 0.30442812795664337}, { -0.23792249915280445, -0.3754929678497564}, { 0.4128032298874137, -0.16376397726989128}, { 0.08322348947884506, 0.4368424514364338}, { -0.44398455152817995, -2.3314106240655614E-5}, { 0.08324964988121843, -0.436872275915787}, { 0.41287917036117316, 0.16374379530159502}, { -0.23785580470393136, 0.37558263021326366}, { -0.3236968530291847, -0.30433938560042173}, { 0.3591496745404824, -0.26135028699614093}, { 0.18891617339129058, 0.40249676808227824}, { -0.43024797713995794, 0.11052415103361486}, { -0.027960310074788223, -0.4440149691206674}, { 0.4404375745316685, 0.05554525073042449}, { -0.1370789889513585, 0.42268133672657066}, { -0.38878290407463245, -0.21437125253981013}, { 0.283337630072025, -0.34264331825785327}, { 0.28331238344669984, 0.3429122703062423}, { -0.3889419933603355, 0.21464329996887552}, { -0.1373180594272028, -0.4224955422606225}, { 0.44006998472247766, -0.05541983756286481}, { -0.02838434763685799, 0.4438769780070184}, { -0.4305416597421443, -0.11082535256770738}, { 0.1887413184081209, -0.40294738034717625}, { 0.3592735324147511, 0.26080078116258326}, { -0.3232688235511412, 0.3039557640760491}, { -0.23729207269108893, -0.375680846326923}, { 0.4134088188997873, -0.16352852734398682}, { 0.08359511271395152, 0.43732627705430416}, { -0.4439301724043016, 6.154513139431246E-4}, { 0.08291525171521656, -0.436331272160017}, { 0.4123047909987934, 0.16398545044849555}, { -0.23843352598200832, 0.37541939267997476}, { -0.32397839308241333, -0.30469788032657513}, { 0.35853422417505015, -0.2618973819829686}, { 0.19172953790830938, 0.4004275096415858}, { -0.43469333775125873, 0.12290874280426758}, { -0.04064446572809237, -0.4893435421637699}, { 0.5459572805350463, 0.13075574847809668}, { -0.4103410659726087, 0.44449436296780476}, { -0.07903841526180458, -0.5442535623703212}},
                {{ 0.7220378298856525, -0.56257472070061}, { 0.5656605827557508, 0.9629158644296607}, { -1.1867019225512754, 0.4900062683844304}, { -0.33737982996003746, -1.3655664512224646}, { 1.4810725794340927, -0.12279195249992238}, { -0.13178596226920541, 1.5257132630829093}, { -1.500528632462271, -0.4036148838454013}, { 0.6728925717374948, -1.4113881887287343}, { 1.266098768271556, 0.9238254668310555}, { -1.1442135659159096, 1.072969782826792}, { -0.8405101761153325, -1.3247325311920206}, { 1.4584719341151782, -0.5776195624805915}, { 0.2938699764977532, 1.540700733577798}, { -1.5686713315178322, -4.1653421893593945E-4}, { 0.2944371594578437, -1.5413648857237559}, { 1.4593829645656828, 0.5775439656525927}, { -0.8399297767754855, 1.3251484490082917}, { -1.1433268550309845, -1.0729353124562393}, { 1.2688306678784596, -0.9209421729756881}, { 0.6667922562140361, 1.4204298598461662}, { -1.52129590539923, 0.3902393763244443}, { -0.10026239150688093, -1.5668073513516194}, { 1.5554897556239464, 0.19441054071139693}, { -0.48419666551536894, 1.4893159134922411}, { -1.3724454309837046, -0.7578658157020536}, { 1.0034119932284085, -1.2092283138464457}, { 1.0034099250240391, 1.210509970690774}, { -1.3727293062689894, 0.7595248341281088}, { -0.48537976166878494, -1.487392643103068}, { 1.5530387418269345, -0.19297761923333603}, { -0.10362595324751997, 1.5668089230045126}, { -1.5246106536831592, -0.39222894025360033}, { 0.6648107839086971, -1.4243430202342144}, { 1.2694246793485513, 0.9161152401432706}, { -1.1398618562866238, 1.0690710516749617}, { -0.8347306245887615, -1.3263989607405768}, { 1.464470667850184, -0.5756694939404895}, { 0.2977015147726702, 1.5458062254352396}, { -1.5684794628489562, 0.006062868657410767}, { 0.29050916014632217, -1.5360123027487909}, { 1.453275145345209, 0.5784951822305159}, { -0.8422568028609503, 1.3231546780020789}, { -1.1472110995932885, -1.0678932159349845}, { 1.2445764333668607, -0.9298424499608189}, { 0.6825766493017839, 1.3625058298716592}, { -1.4106604555418452, 0.4252291267746837}, { -0.18311601214780707, -1.3784974417573552}, { 1.2625529578317198, 0.01840678585674197}, { -0.16019205123730612, 1.073883730306219}, { -0.8401442239627229, -0.23449885013952254}},
                {{ 0.515775108552595, 0.15225539183329032}, { -0.06294262426229758, 0.5524666843316247}, { -0.5404341626720296, 0.015224294343345046}, { -0.06293782626543759, -0.49075847150029295}, { 0.42161771153955463, -0.07231693370237968}, { 0.04736334158067583, 0.35032859344004275}, { -0.28784530919388307, -3.157340499289618E-4}, { 0.05723459658828069, -0.23750923768360324}, { 0.19700759314864752, 0.11223731276979278}, { -0.1582791842362052, 0.16136917789935915}, { -0.12547285289965354, -0.1924532945676245}, { 0.21519068284386317, -0.08584385361713559}, { 0.04185790048488284, 0.22882490919823262}, { -0.235482313168667, -0.004026099772305658}, { 0.04775891061437739, -0.2350777201447397}, { 0.2250429718886155, 0.08656707582238683}, { -0.12118486820764414, 0.20274508269979263}, { -0.16912960863415222, -0.1549564837723802}, { 0.18963591045779632, -0.13009562220052764}, { 0.09307389758978205, 0.22131492447822879}, { -0.24120237665373803, 0.060737591373014405}, { -0.027690312195285456, -0.24229380184288912}, { 0.22676983714344864, 0.015153128275100883}, { -0.07070112524749875, 0.20635280807993292}, { -0.19298801605021454, -0.12925527703692502}, { 0.17342751364823028, -0.18695432500114795}, { 0.1741808291328849, 0.19234648381018715}, { -0.192712805820994, 0.13782406210966558}, { -0.07534302583726561, -0.19470200678199948}, { 0.2138464509965739, -0.00480242254603891}, { -0.04793504548297416, 0.24465856932900526}, { -0.26257665890360277, -0.07143753632153715}, { 0.07979559791114041, -0.24485743999737952}, { 0.1922409015405127, 0.10053458868873542}, { -0.1488071909672035, 0.13055787306938957}, { -0.08919890168023313, -0.21154303874785818}, { 0.2570958366609283, -0.07547231297154108}, { 0.06865121538740705, 0.26230565912952164}, { -0.23212922569009814, 0.03941121646003271}, { 0.023496057077832196, -0.19386600654527056}, { 0.1719609355936721, 0.10415375153217978}, { -0.17574719850574824, 0.16745470803115795}, { -0.16106063014558825, -0.22603685448800478}, { 0.2677386291472964, -0.13615233933212045}, { 0.09954158934584133, 0.3243284818437538}, { -0.4045010462210889, 0.08056638996546255}, { -0.10897943229925082, -0.48827502714013626}, { 0.5367324771958016, -0.19032700088320695}, { 0.2985357614556826, 0.5172961659730946}, { -0.4249689611768742, 0.390357770574099}},
                {{ 0.2567978487028358, 0.10197317429583597}, { 0.03643146010776216, 0.26298241852832693}, { -0.19352773171685675, 0.14803859289678628}, { -0.19671775180466833, -0.0834466634983407}, { -0.02132287376724093, -0.1780937957245784}, { 0.11536300781277893, -0.08716029949955445}, { 0.10440109602751584, 0.04204797141904207}, { 0.015115923453167174, 0.0838675919844118}, { -0.04537729930773698, 0.04389016793064654}, { -0.044956030613683404, -0.007762868409850673}, { -0.015715843197448287, -0.02720418329513524}, { 0.004134035569311481, -0.019127287462872997}, { 0.005822885569532596, -0.009834880258882229}, { 0.005943434390875626, -0.011269922928743943}, { 0.015740428418009506, -0.01165013431636452}, { 0.025723694911941694, 1.8291465847366552E-4}, { 0.02422078706569884, 0.018244911620269838}, { 0.011595629572903925, 0.033029316884307484}, { -0.009809186572677767, 0.04056493632685463}, { -0.037756432365557105, 0.03339220226626209}, { -0.05895190102736037, 0.00499040061587123}, { -0.05678194981807365, -0.035035680749477854}, { -0.02913116295420168, -0.06774934855019168}, { 0.015240890476682938, -0.08071059089418677}, { 0.06556690902852977, -0.06547957884511527}, { 0.10244179186592552, -0.017099733050208652}, { 0.10167394566932657, 0.050806227136194676}, { 0.05690229818061581, 0.10746488813452972}, { -0.015249207767511694, 0.12822371783702904}, { -0.09073077194996874, 0.10366190793390202}, { -0.14276150322154063, 0.03517493852042693}, { -0.14381731860815403, -0.05746588656752522}, { -0.086027195548408, -0.13482346113170202}, { 0.007481617728795895, -0.16280349631590885}, { 0.10084769092700548, -0.13169748091693248}, { 0.16143138482460015, -0.050307207760798896}, { 0.16119529958412768, 0.05554623135787394}, { 0.0926029413080176, 0.13883213709672187}, { -0.01024637863332258, 0.15567173364981124}, { -0.08855487868814817, 0.10501977663708692}, { -0.10728447247874769, 0.03297203133548891}, { -0.08608094654964055, -0.008676218582096797}, { -0.07983592868867469, -0.017061492268463006}, { -0.107323047323274, -0.05230830723366205}, { -0.09332890411527357, -0.1581012638492254}, { 0.0572497632367116, -0.2486226052792961}, { 0.28229070517838806, -0.15361771861330908}, { 0.3436719057996809, 0.14436322792816314}, { 0.09753598158964095, 0.39079145368517304}, { -0.2654064110445008, 0.31082625807109476}},
                {{ 0.19624277954537142, 0.06012032699647195}, { 0.08006078041093595, 0.1819428347663677}, { -0.08080124450928419, 0.168353961544888}, { -0.16460127874129946, 0.04322303569907765}, { -0.12275499744724794, -0.08725209261053904}, { -0.008516534196719078, -0.12958399980328938}, { 0.08184402666165769, -0.07330032823129393}, { 0.09083291773167536, 0.018293770877448795}, { 0.032794058075975935, 0.07263325041405329}, { -0.03588265439947354, 0.06219276744103093}, { -0.0679937612854045, 0.009340061837651945}, { -0.05242716956310358, -0.044968569937855675}, { -0.006700912655642488, -0.07179751104470768}, { 0.04406724793712938, -0.06338552399749742}, { 0.08040742018780864, -0.026067406171625104}, { 0.09007534209894022, 0.02819913693344967}, { 0.06615942493954571, 0.084077745728069}, { 0.00882020012741955, 0.12204369024418554}, { -0.06984562825103106, 0.12154292232149863}, { -0.1439372265149579, 0.07023488575354647}, { -0.18015216316953953, -0.025833920555318305}, { -0.15165910931604465, -0.13845262330741417}, { -0.05302418444033987, -0.22382953768146932}, { 0.09147332776410078, -0.23869291863359315}, { 0.23158598939514138, -0.1604304793154549}, { 0.30799075360656786, -0.002094415656764577}, { 0.27711670900498375, 0.1864454600721004}, { 0.1329934599679053, 0.33371864147212327}, { -0.08371169859445379, 0.37399601900534635}, { -0.2963159236797873, 0.27667000479517223}, { -0.4203386713244909, 0.0641883561928202}, { -0.39851936765042484, -0.19146748811819042}, { -0.22783957049551837, -0.3944422962275648}, { 0.03453888223127086, -0.4636406352182689}, { 0.2919542910101871, -0.3682561851188683}, { 0.44842774762416593, -0.14270059811398622}, { 0.4494214794185976, 0.12854512798039647}, { 0.3020675126439811, 0.34916303357972084}, { 0.0648862829809049, 0.4507932265650238}, { -0.18377398541170578, 0.41230441744383595}, { -0.3752180143889725, 0.25262885053292583}, { -0.45999503785405166, 0.013061914806336717}, { -0.4044591165185494, -0.248707419523845}, { -0.19931270464051246, -0.4518703842084865}, { 0.11079513294453859, -0.5013956511848339}, { 0.40768588258081906, -0.33725315128396693}, { 0.5367685731674104, -8.601953984961266E-4}, { 0.40402330588300644, 0.34864667573645663}, { 0.06432296626369224, 0.5143145969968045}, { -0.28837728257017003, 0.3973541287409393}},
                {{ 0.1682289851694548, 0.033987209251850434}, { 0.10156296522081981, 0.13172011050481747}, { -0.008382169193495409, 0.1558250728750204}, { -0.09780184568420648, 0.10183192922189471}, { -0.12207326418822383, 0.01209872002202278}, { -0.08272130695456148, -0.05739092511284645}, { -0.019370055441922884, -0.07413853533200092}, { 0.022577722003103515, -0.044820876317681474}, { 0.021603254373336628, -0.005177691536275841}, { -0.009521355412468152, 0.007049773296906009}, { -0.035050664977927165, -0.020694319221357352}, { -0.022263951669552244, -0.06790292594850054}, { 0.03519807821368105, -0.09660495327269435}, { 0.1129499442749195, -0.07499379427843372}, { 0.16922765001831105, 0.005393537655754777}, { 0.16415393701287787, 0.12241251068583794}, { 0.07843365988803068, 0.22859952101045106}, { -0.07312195654721229, 0.2702218563441021}, { -0.24178625540551796, 0.2108532611539357}, { -0.360809481648826, 0.04827358720839814}, { -0.3689902254164086, -0.17816932928700813}, { -0.23533960079808314, -0.3926835423992741}, { 0.020456358709776343, -0.5063916691682199}, { 0.3238705785678438, -0.45321086225988383}, { 0.5665219719254877, -0.22087524550552712}, { 0.644873322725872, 0.13540032860197337}, { 0.5009400911040313, 0.5014796712458262}, { 0.15554058843071328, 0.7408265083582845}, { -0.29066661106237246, 0.7478519809242425}, { -0.6865592647847129, 0.49264319898719433}, { -0.8826433815526278, 0.03996897853127063}, { -0.7903158537594326, -0.4651829833733691}, { -0.42189762504634865, -0.846467384911196}, { 0.10934497080051032, -0.9628535226366414}, { 0.6275029272143328, -0.762465207759388}, { 0.9544576703804017, -0.3024311506354437}, { 0.9733091693175792, 0.2684879310358721}, { 0.6718560626092255, 0.7592235613125533}, { 0.14739888097771925, 1.0029987989151077}, { -0.42630781102388743, 0.9153067672375413}, { -0.8549867506687374, 0.5227022746519999}, { -0.9886037904148706, -0.042493067747370286}, { -0.778284564351651, -0.5815280769574691}, { -0.3012278124924185, -0.8986827299157372}, { 0.2624797521739549, -0.8788628893034449}, { 0.6962684267501271, -0.5382299359531938}, { 0.8352206907487936, -0.022637757456588227}, { 0.6408928568069495, 0.45090604045592225}, { 0.22101650276811569, 0.6913406368663186}, { -0.22474386968096977, 0.6234578184588387}},
                {{ 0.16958896997145317, 0.01695860218026679}, { 0.128761408898566, 0.10873805669252705}, { 0.04697182208952935, 0.16000054609800413}, { -0.04301028847790107, 0.15749965545735978}, { -0.11473276502883847, 0.1093363320960873}, { -0.14920125704160486, 0.03699265564975018}, { -0.14254645913914354, -0.0353890506651785}, { -0.10954098949186636, -0.09280493182098513}, { -0.06430318222453231, -0.1332837954960509}, { -0.006104703502963563, -0.1586445110938275}, { 0.06765900401879608, -0.16386971223284538}, { 0.14932627521252034, -0.13658513038851172}, { 0.22398984759759727, -0.06363457569492992}, { 0.26628116049811024, 0.05901180709532616}, { 0.2382174386511047, 0.21325831042357027}, { 0.11330756288628108, 0.35290351733379854}, { -0.0953221226237321, 0.41638795758417685}, { -0.3356627719810261, 0.3523117982618696}, { -0.5311745013374712, 0.14378877329389467}, { -0.5947159203277756, -0.17436965870511392}, { -0.46207710473735125, -0.5129718402649793}, { -0.13560740198663604, -0.7513842297161266}, { 0.30542924229035245, -0.7812904952683265}, { 0.7297847373743517, -0.5504011030817032}, { 0.9872247061549467, -0.09089247068987527}, { 0.9549176979659739, 0.47590373449969764}, { 0.6019122987879425, 0.9703740483432852}, { 1.64893776185246E-4, 1.2124322759307589}, { -0.6751082121161236, 1.0871940630655317}, { -1.2008098146555424, 0.5966210173368601}, { -1.3899148173979767, -0.13052292872398066}, { -1.1534829724713866, -0.874177791424276}, { -0.5341781542012702, -1.39066628143246}, { 0.289156667190617, -1.4956866734193082}, { 1.0531901514536948, -1.1349515707844626}, { 1.5079582238486955, -0.409497899914276}, { 1.5022013860033663, 0.4553416132869554}, { 1.0287138440102286, 1.1823913129199821}, { 0.23571950916858336, 1.5347839731919017}, { -0.6137086905547452, 1.4004133107800771}, { -1.2401486016937882, 0.8332515566725778}, { -1.4502086825568674, 0.03197890667241809}, { -1.1935968521196823, -0.7316949233926289}, { -0.5767278520788629, -1.2079760884841426}, { 0.16985238254193377, -1.2578695612470454}, { 0.7822560373858636, -0.900908782078529}, { 1.070318487904148, -0.29788026810009155}, { 0.9766038042574328, 0.32005450415497205}, { 0.5793289491466519, 0.7410979801091909}, { 0.05735322011426538, 0.8488347164681783}},
                {{ 0.17935821250939227, 0.03653629626437718}, { 0.14185176952905504, 0.12468419335400488}, { 0.05765628933058464, 0.18801354556220204}, { -0.05372786513354833, 0.20454625440095503}, { -0.15913733771810024, 0.1548260229325174}, { -0.22707373516066043, 0.05380181473530235}, { -0.23938985194660362, -0.06586999046904592}, { -0.18750010766728548, -0.18415538983162769}, { -0.07336173359724832, -0.2760814592842384}, { 0.08151701516085981, -0.30129021849645776}, { 0.24019568621755205, -0.23977248562681713}, { 0.36283176938213835, -0.10334660915825133}, { 0.409212190075897, 0.09088708827506431}, { 0.3440222002691213, 0.31249776091240794}, { 0.1576157363193236, 0.49360302488010216}, { -0.12010848727675112, 0.5596872395205748}, { -0.4261849593622132, 0.47241029686346553}, { -0.6747451894285122, 0.22525413344481182}, { -0.7713559181020673, -0.15455432230448934}, { -0.6476083569300854, -0.5752756988330624}, { -0.2981972023605824, -0.8984575711800245}, { 0.2094375164482063, -1.0061313681718502}, { 0.7474703296930882, -0.8333103986814341}, { 1.151673745297774, -0.37575890304500364}, { 1.269349665662164, 0.2764037261335937}, { 1.0213347781490623, 0.9369480336398028}, { 0.43468611533170026, 1.400095050465334}, { -0.34979051954253043, 1.5084040303836397}, { -1.115804229490637, 1.1846888028980644}, { -1.6272771466563187, 0.47467451175186615}, { -1.7031091244775265, -0.4310565069331588}, { -1.2890630354278196, -1.265424364919836}, { -0.4825208140842585, -1.7835901031927508}, { 0.496553516201593, -1.8184110576753763}, { 1.3650412631446378, -1.3296376690240999}, { 1.859410693906187, -0.44982457741130955}, { 1.8272432261939429, 0.5544188362204928}, { 1.2807442844284824, 1.3917231055096315}, { 0.3864600813687854, 1.8270939392844452}, { -0.5880957456248799, 1.7339043008724981}, { -1.3531437964154718, 1.1518536125389336}, { -1.69188138787598, 0.2853080872626671}, { -1.5330899368861661, -0.5922040056582883}, { -0.9615820561093353, -1.2343157957655888}, { -0.1772093033039394, -1.4720248533885543}, { 0.5703765417322815, -1.2653151264077762}, { 1.0633001251213743, -0.7297491236337823}, { 1.1891965841567413, -0.07210001932815452}, { 0.9649837891863575, 0.5057905558758263}, { 0.5085076040201608, 0.8517547270450827}},
                {{ 0.15332587225989508, 0.07339991530628642}, { 0.11047801338292404, 0.15183209756005597}, { 0.015688838892182505, 0.19498639058273556}, { -0.1056939133095937, 0.17916297351851482}, { -0.19624660254863646, 0.10218011127191096}, { -0.23528826953839083, -0.01740271012147923}, { -0.22094116044997877, -0.15311230657340263}, { -0.12812039785964957, -0.26852983590312063}, { 0.04056288592439322, -0.31898747569559416}, { 0.22272914830417428, -0.27463979268462324}, { 0.3620184110749655, -0.13501062914054357}, { 0.43175144026017553, 0.07778132234877909}, { 0.3878865629575144, 0.31917890170286983}, { 0.19626378049098164, 0.5188553164279744}, { -0.10030476408002549, 0.6029447655156375}, { -0.4170197215056447, 0.525388234743859}, { -0.6847446960524186, 0.2778190906191294}, { -0.8216552420357117, -0.10602229930741058}, { -0.7354354484605741, -0.5401050271837682}, { -0.40977682937268484, -0.9010236938725538}, { 0.07836411066407092, -1.0714214974226204}, { 0.6249622044397078, -0.9737257333443619}, { 1.102931793617331, -0.5892372711300293}, { 1.347336087594059, 0.019599412635854362}, { 1.2410810824293304, 0.7076564168235108}, { 0.7910172681745096, 1.2897740707733425}, { 0.06682477975213945, 1.5900585752826766}, { -0.7371644159756937, 1.4955390471204315}, { -1.4147738335326676, 0.9989259596680463}, { -1.7902700744562696, 0.1999878640808023}, { -1.7229839809350387, -0.7093877357348097}, { -1.1885680490075499, -1.4854596106914852}, { -0.32893466458108495, -1.9094620521075836}, { 0.6304760081668351, -1.8584903779675062}, { 1.459695555416808, -1.3339619832786207}, { 1.9347592657035677, -0.4628563045680319}, { 1.9054014165048907, 0.5248826359506933}, { 1.3924150765578875, 1.3635684111001234}, { 0.5584373996943564, 1.83824424210458}, { -0.3851899450017015, 1.8390272031097121}, { -1.2007375292648195, 1.3813628673432472}, { -1.6618944583360895, 0.6061873637504357}, { -1.6664548700074595, -0.2607124163929671}, { -1.2701692432877048, -0.9877943734255968}, { -0.6071968119044368, -1.4042468159867003}, { 0.14649580886765612, -1.4322021306912918}, { 0.776326867782907, -1.1031178954355922}, { 1.1182979195157672, -0.5476305938092122}, { 1.1394690400957017, 0.05852350640612113}, { 0.8917454398577597, 0.5564835617709405}}
        };
        Complex[][] cplx_res = UtilMethods.matToComplex(result);
        InverseContinuousWavelet icwt = new InverseContinuousWavelet(cplx_res, this.widths);
        double[] out = icwt.transform(InverseContinuousWavelet.waveletType.MORLET, 5);
        Assertions.assertArrayEquals(this.signal, out, 0.1);
    }

    @Test
    public void testPaul() {
        double[][][] result = {
                {{ -0.4275810687327184, -0.46617591162384664}, { -0.3470896071580378, 0.4877116789147927}, { 0.4907009199969415, 0.3129623672443935}, { 0.17418419542747945, -0.6172033786906075}, { -0.5491302140109666, -0.0809323223656029}, { 0.038554899497955, 0.648634379226366}, { 0.5423363418465253, -0.16181761661921754}, { -0.23549356669377058, -0.5890166297710734}, { -0.45347081657279836, 0.3797199662133549}, { 0.39489594571627773, 0.44176351315670387}, { 0.2792124011002275, -0.5515150620321585}, { -0.542235541765125, -0.24076905268535512}, { -0.12878592480160875, 0.6397434114276251}, { 0.5431018264831687, 0.006108934602984224}, { -0.0930863038849388, -0.6272265040687757}, { -0.47078627116221305, 0.253333709004192}, { 0.3826758284382401, 0.5619123686650492}, { 0.5171627823987898, -0.4380431248221904}, { -0.3388782011265963, -0.38782587276508346}, { -0.1665713392016704, 0.5656837180940109}, { 0.5247607113232483, 0.12420140933057719}, { -0.09451781500238059, -0.693437496972667}, { -0.798492778271837, 0.04194966188417157}, { -0.15327102224946346, 0.5995901825191197}, { 0.16173976262218068, -0.29702463683224134}, { -0.579297260677428, -0.4459426222207209}, { -0.38218601844212086, 0.5860203368164995}, { 0.7129877076260813, 0.40875838603647896}, { 0.6384501996620849, -0.5399946511289004}, { 0.06635479192547657, -0.04895339559308645}, { 0.6544617068934335, 0.6185410286814919}, { 0.9877709165728835, -0.25267139601195554}, { -0.09960872980820819, -0.7195523782208874}, { -0.6873261343272545, 0.24502354411438013}, { -0.16527678303248813, 0.3420411142008472}, { -0.46856163628364544, -0.5865968213145067}, { -1.283905240848766, -0.20111180842399887}, { -0.6750627259558957, 0.7408682401867968}, { 0.3190674627363339, 0.13685971188979265}, { 0.03300959293315106, -0.50649204061206}, { -0.06832590472520092, 0.33029292360624174}, { 0.9176034898302021, 0.5783658864849457}, { 1.0237866937686126, -0.4771977229119481}, { 0.016469595363035352, -0.459736260268067}, { -0.01136963606486122, 0.4920614328511462}, { 0.5112700164583476, 0.07613737603810891}, { -0.1902361573914032, -0.7027707504755469}, { -0.8793860583071139, 0.06571173314910016}, { -0.1602278340218478, 0.6331752238481806}, { 0.23189559100007887, -0.33339473815919624}},
                {{ 0.29334981967748275, -0.6733467430461463}, { 0.40633697377755806, 0.7632365710515041}, { -0.6527762252995233, 0.4837351192231792}, { -0.22434622883144703, -1.0182904311390628}, { 0.7463319536166735, -0.1340369925407479}, { -0.045353698810391085, 1.0620074582088235}, { -0.7247396305483335, -0.2637673510711426}, { 0.31784784899194524, -0.9621092873345138}, { 0.6039681096882211, 0.6242337660918409}, { -0.5474394553036569, 0.7255766421552977}, { -0.4022937250907229, -0.9015988154971041}, { 0.6961946547841747, -0.3954922897897292}, { 0.1430690690333799, 1.0421126735721051}, { -0.7429513360694452, 9.03474055716436E-4}, { 0.14738632986523342, -1.0386312640136277}, { 0.702580639299982, 0.40295201950250625}, { -0.39761249107330526, 0.9127187111389246}, { -0.5482472707844719, -0.7145981783888299}, { 0.5954572495433359, -0.6192620864370453}, { 0.3025468278254732, 0.9549853076329247}, { -0.7429790149383333, 0.24139064313413972}, { -0.06090210220984719, -1.0971748026159833}, { 0.7388905531743262, 0.09408302329842759}, { -0.22079383557063256, 0.9823227148106797}, { -0.6322032503718842, -0.5174602726337868}, { 0.5075769591363031, -0.7923148658958372}, { 0.5046641815868907, 0.8770052899650445}, { -0.6413543912840407, 0.5868425903364304}, { -0.23661099379269765, -0.9424161696180234}, { 0.7175349283685188, -0.09423968683603098}, { -0.0837471592888577, 1.053067144811237}, { -0.7606868471566774, -0.32305385547603616}, { 0.2969569588468652, -1.0570795009620466}, { 0.6063675626085167, 0.5218955033423213}, { -0.5219845012895112, 0.6487502660998318}, { -0.3634040162746314, -0.9275866608870156}, { 0.7334118100240948, -0.3618334753546842}, { 0.16379025888505255, 1.1238944078053315}, { -0.7474577306206064, 0.103214368611488}, { 0.11855306503481972, -0.9498513000357014}, { 0.6599802991608692, 0.45010367164087495}, { -0.43802379874176145, 0.9063440516371232}, { -0.570862495118097, -0.7668578875469314}, { 0.5995296383448258, -0.6940192342475389}, { 0.3318184470964187, 0.8876734841021124}, { -0.7000658082837512, 0.20612070650145983}, { -0.022199621344894616, -1.0929398499285012}, { 0.7578690379785908, 0.1186634693341421}, { -0.19386863842126073, 0.9725091829814252}, { -0.38370728039133006, -0.4587776098882519}},
                {{ 0.5690593538714466, -0.38108500270632994}, { 0.43754047676027324, 0.8014639423822433}, { -0.8997450206763302, 0.42248129604813744}, { -0.301375583118023, -0.9635177377637036}, { 0.9557414674763759, -0.13520218828342334}, { -0.05670708664741287, 0.9741765971234773}, { -0.9282823755554952, -0.24375439553724063}, { 0.4047992222215551, -0.8872201202656737}, { 0.7709877963857429, 0.571298055224344}, { -0.7010183504779415, 0.6621037719560297}, { -0.5111360116882341, -0.8382263646885516}, { 0.9008094471825793, -0.3720548498134222}, { 0.19781351717126144, 0.9555436500076154}, { -0.9345272871428953, 0.004795188563827868}, { 0.20162254850827652, -0.941787841542754}, { 0.90136752218072, 0.3957631665463296}, { -0.5249589026544886, 0.8702713843211024}, { -0.7376260684078836, -0.6325831437521617}, { 0.7120085718898848, -0.5612332732316225}, { 0.3353109532619854, 0.8616517983204182}, { -0.9859912624452456, 0.1747312442481154}, { -0.07586096176929737, -1.0803898361993085}, { 0.9969669763240863, 0.012308077316275524}, { -0.18580935149510763, 0.8517475250962533}, { -0.6871686864948816, -0.4829452622618246}, { 0.7622139590343844, -0.6759442762177789}, { 0.7079081442388693, 0.9160551585692247}, { -0.8415873577698166, 0.6778143783767986}, { -0.41443705283134413, -0.7425889241098358}, { 0.7370262086178014, -0.017540299921046415}, { -0.3114358158652134, 0.9527292895733872}, { -1.1392677080527267, -0.4046035989337091}, { 0.3088717179053, -1.1444023611316412}, { 0.8277732130879162, 0.2953568935845783}, { -0.5032741368395419, 0.4555927509486883}, { -0.2321560579374675, -0.9070480936169237}, { 1.1720527929490125, -0.28006950963293525}, { 0.37456750445241416, 1.1767054202783518}, { -0.9058945645520419, 0.280239296660291}, { 0.08006517811915166, -0.7034120003311924}, { 0.6791150127869746, 0.5216476610522833}, { -0.7656734361823534, 0.8511550793941844}, { -0.9136763171424954, -0.7760280134102541}, { 0.6541446607929879, -0.7656798786821373}, { 0.40173592835982164, 0.6757490737405466}, { -0.8363579946325609, 0.07062452302134392}, { 0.09156083629651189, -1.083776329081202}, { 1.1425045072620683, 0.07966098865995216}, { -0.01852199950166977, 0.9948530757146552}, { -0.5989513183795355, -0.010285714087349133}},
                {{ 0.5610362108765559, -0.11230174301049575}, { 0.25099188130937633, 0.6602209167820415}, { -0.658891867983762, 0.3018421594852861}, { -0.2399195891936657, -0.6171082806590681}, { 0.5899701529435866, -0.10515317135844626}, { -0.04105657472138028, 0.5927418097546806}, { -0.5923950925742275, -0.16006003642205935}, { 0.25319909748888914, -0.5600773096154964}, { 0.4864665930098086, 0.3441608599964292}, { -0.4433631587447316, 0.3969461888810402}, { -0.3144256821155468, -0.5374301466814645}, { 0.5921330031592079, -0.2430941099113127}, { 0.15472893883698557, 0.5942522728163327}, { -0.5614851472986895, 0.02124250741334849}, { 0.15072112985515748, -0.5462212427758657}, { 0.5718960813641903, 0.30235767067574776}, { -0.3675032116566749, 0.6001207515729345}, { -0.5391556304407771, -0.3535788053972222}, { 0.35499173833196956, -0.351497147923804}, { 0.11558677997600716, 0.4747305316141926}, { -0.6875306929626602, -0.011448389331168202}, { -0.03957790753566448, -0.8287255575518683}, { 0.7318284573828918, -0.14199934652555526}, { 0.06470108086348422, 0.4414713599041056}, { -0.20944945075298416, -0.28025366304295835}, { 0.6889568826219167, -0.2711981794088986}, { 0.5599113274767393, 0.8279776695961236}, { -0.5736156634269306, 0.7261344958315822}, { -0.4670796546787292, -0.2012241027132554}, { 0.13827480026442368, 0.11596566769649413}, { -0.5657186441093267, 0.5276713081660567}, { -1.0197822419724405, -0.5099409028415649}, { 0.06833713572225045, -1.1017994965508469}, { 0.617498249183901, -0.22871605968673267}, { -0.024274897812737544, -0.028679012852570376}, { 0.2689399159523245, -0.6802131673400336}, { 1.1601987462406054, -0.0582129141650374}, { 0.5327134714972489, 1.043991096319725}, { -0.4833313262809014, 0.5866853440898179}, { -0.07765971823362937, -0.04790931315583868}, { 0.1332009650167985, 0.5819491027486882}, { -0.8557426764248341, 0.592790173065297}, { -0.9117119931092401, -0.6129333099627452}, { 0.2089303178582128, -0.7438365110331707}, { 0.21609088358662445, 0.10288091536825263}, { -0.40896079359938475, -0.23583778002826367}, { 0.304060826540898, -0.8478367641267279}, { 1.0434587473980952, 0.046093534839807715}, { 0.2461183872401085, 0.8648780543536061}, { -0.46684294174454066, 0.3484442547965787}},
                {{ 0.44930792570182476, 0.02382547950245867}, { 0.15033963814684115, 0.4704985482316616}, { -0.3800952533874349, 0.23254470473320357}, { -0.1854978676295037, -0.27479562665957036}, { 0.23357255947825759, -0.06515087630304665}, { -0.0420444895801127, 0.2580632747144969}, { -0.29165548961338755, -0.09393608022706917}, { 0.11090245237234975, -0.2823832137545974}, { 0.22672254539950382, 0.13905947725132312}, { -0.20046933139889597, 0.16126401879029528}, { -0.1257819506800175, -0.2752048500998753}, { 0.31577181260663284, -0.12597746618280786}, { 0.12029313289794862, 0.2887358633545752}, { -0.2191297138896504, 0.049345364366938566}, { 0.09448080533879714, -0.18697729330335486}, { 0.2515096937547672, 0.23008578180290204}, { -0.24476766111708367, 0.36391916459736856}, { -0.3783197391980322, -0.12358845077777322}, { 0.012649341235018355, -0.19542262365829108}, { -0.08545306179726289, 0.10090008521214602}, { -0.3936714672291483, -0.21058389898910843}, { 0.029675564761096115, -0.6354094910172576}, { 0.5335648400468813, -0.283143901269366}, { 0.3395490642343249, 0.10262499096260809}, { 0.2607009056933878, -0.05880722603876794}, { 0.6287158136272122, 0.14363177650904774}, { 0.4030858039612673, 0.8156605203284888}, { -0.3725464071124399, 0.8201494720119159}, { -0.5763191370407408, 0.2966858939411173}, { -0.4754894991730489, 0.22313087281407223}, { -0.8507058048953849, 0.11274761695631108}, { -0.9374626773538232, -0.6717008762095935}, { -0.1516191418113627, -1.145562408371354}, { 0.45363080012390394, -0.7609860096934712}, { 0.4686893429509491, -0.5040125461928462}, { 0.7949147008643878, -0.5012203578690178}, { 1.2138043603824926, 0.1541372449429328}, { 0.7300161689969635, 0.9801709438683035}, { -0.06497095499313227, 0.9281330258159841}, { -0.22166728162966196, 0.6041237680342686}, { -0.3970501689377313, 0.7026312419079899}, { -0.9887822009009848, 0.4083332040608829}, { -0.9698012237518238, -0.46491427756657755}, { -0.2550862390406059, -0.7539268047658532}, { 0.012385850167756212, -0.4500862333689916}, { -0.01709167648546543, -0.5567880994656119}, { 0.5166982199490251, -0.6643502164689046}, { 0.93401305826844, 0.02832774705513544}, { 0.42206582541035953, 0.6908083179232901}, { -0.22857948965040828, 0.5175039533948188}},
                {{ 0.34616593756197966, 0.06456823541651663}, { 0.12469704972587631, 0.3275021142100129}, { -0.18806126408049492, 0.20904837083650457}, { -0.1481976341298505, -0.05628819501813126}, { 0.025945481517206048, -0.022575193316693082}, { -0.0608158762160457, 0.08174230176946205}, { -0.14103324251820049, -0.06444406390581453}, { 0.03005855762267512, -0.14267466618809355}, { 0.08909233933461719, 0.01916054225202738}, { -0.06118334014854, 0.028539513402496063}, { -0.012673918348865807, -0.13359462139242056}, { 0.17681582471559004, -0.05503094766897136}, { 0.10682882421486888, 0.13926322722661008}, { -0.037944767949501204, 0.0842043748037652}, { 0.04859555156042251, 0.025548260143116057}, { 0.05106297538125825, 0.20234442643985193}, { -0.21301090227706218, 0.23317691622344805}, { -0.32451093576883044, -0.022267765366341414}, { -0.19364641938077926, -0.15263860471775872}, { -0.19368157616474513, -0.1539151126621443}, { -0.20613052771601043, -0.37111014199650677}, { 0.12324814354897798, -0.5689798076897951}, { 0.5004928669798522, -0.3671897562233366}, { 0.5638592802522395, -0.04968664858326395}, { 0.5725358292588875, 0.12821125694705265}, { 0.6175035869712455, 0.4608670029278559}, { 0.2926973877434363, 0.9086131262714393}, { -0.3362517584763473, 0.9521110269011219}, { -0.7421456779866734, 0.6060674393085207}, { -0.9258175020848491, 0.26813050167988356}, { -1.1080958180941833, -0.1786318525257811}, { -0.956747630490214, -0.8696026043631669}, { -0.2781158841752607, -1.299814993139379}, { 0.417759101262769, -1.1699406292115395}, { 0.8377065320924054, -0.8466683462465561}, { 1.2096893905817923, -0.43630744860059456}, { 1.373392368700302, 0.29902701531172693}, { 0.9393068765540246, 1.0310942060157438}, { 0.2137789440966295, 1.2326724464482848}, { -0.3066703014953026, 1.0839458715490302}, { -0.745938278472418, 0.8754817423688078}, { -1.161079527430995, 0.3731235521278576}, { -1.1138806535471082, -0.3760557887363484}, { -0.6019512767147414, -0.8017468211429382}, { -0.15443824431960643, -0.8230002108091761}, { 0.18323374156488784, -0.807431012260352}, { 0.6465359159952155, -0.6202121028526164}, { 0.8840445435120504, -0.021644077399859112}, { 0.5363063117683219, 0.5281427337258793}, { -6.195695403228639E-4, 0.5522950238644667}},
                {{ 0.27705469055078363, 0.06573947320727869}, { 0.12668055287082236, 0.2377131344174156}, { -0.07466016741409762, 0.19818185209200406}, { -0.11515346188998529, 0.05812937155685688}, { -0.06500792865885499, 0.01744382964031152}, { -0.08140250478968691, 0.017680593876624247}, { -0.08916919396892277, -0.05253323049569892}, { -0.00972693973665155, -0.08948730700284098}, { 0.032262285430643106, -0.037007098848541586}, { 0.0037619652221046237, -0.02912800225811448}, { 0.042745355040337114, -0.06916025598960492}, { 0.12343422538615838, -0.013275253836065369}, { 0.09955863648582249, 0.09317684949732911}, { 0.026429067075996397, 0.11643242058324633}, { 0.005948651272424929, 0.1271766595082525}, { -0.06484737080734368, 0.19048388739733854}, { -0.23245937623211924, 0.16061319524556655}, { -0.32658647570417604, -0.015221724660506773}, { -0.28701245940179815, -0.1837237990558502}, { -0.22006802588557578, -0.31376368074928657}, { -0.08118647525686097, -0.4808436627561248}, { 0.22904392406084595, -0.5588915857179494}, { 0.5599453627975141, -0.3866038815880799}, { 0.7209109334734265, -0.06222009509543096}, { 0.7382749743107051, 0.2865407389830964}, { 0.6071720185411044, 0.6860965704487976}, { 0.19771384245974735, 1.0310226981393151}, { -0.40470435268717986, 1.0627901890885783}, { -0.914523436412473, 0.7493230057276288}, { -1.2157572400577776, 0.25326463071551764}, { -1.293797194728808, -0.37632398544062484}, { -1.003189642672416, -1.0547607388540308}, { -0.32322008014030956, -1.4741017507434337}, { 0.45562192450503236, -1.4386325775055724}, { 1.0812917124729153, -1.056962032273123}, { 1.4919093101814687, -0.43287890858152134}, { 1.548038359331847, 0.3820151942618271}, { 1.1158639891041477, 1.1163420761464418}, { 0.3851798693293463, 1.4549489757083454}, { -0.3325250325886278, 1.3925180797159609}, { -0.9280668520591006, 1.0469254296690245}, { -1.3050761385408323, 0.43057781113683996}, { -1.2654943760749113, -0.3052602748503827}, { -0.8382649492002411, -0.8299930384339869}, { -0.2965332654313101, -1.02044236354384}, { 0.22142489677537266, -0.9694293379065153}, { 0.6745965684351779, -0.6637213127358303}, { 0.8522704592341859, -0.11675642245775918}, { 0.6134433271308471, 0.37085999103464784}, { 0.18586755229774043, 0.5085508648403962}},
                {{ 0.23468772754780967, 0.056258237552082146}, { 0.1322143074347732, 0.18300278274109427}, { -0.010975374571493057, 0.1865744130200922}, { -0.08358329578013728, 0.11123171813810509}, { -0.09203620730601753, 0.050522904916941724}, { -0.0938553233065708, 0.008680400693119789}, { -0.07823676261209747, -0.04196433653060498}, { -0.02861703335644486, -0.06942020100402063}, { 0.011879429572503597, -0.057091404132606924}, { 0.03007791127216944, -0.04642906513418789}, { 0.06515325746569557, -0.03734859200264102}, { 0.10194214983338795, 0.014868893814172134}, { 0.08624037905500072, 0.09113861690310808}, { 0.02917264635994416, 0.13878733182466907}, { -0.03748176024023028, 0.1644721015985612}, { -0.13679072840136294, 0.1719948666600095}, { -0.26327684409125757, 0.10388694445432721}, { -0.3355576104702241, -0.05616758711526464}, { -0.30638416684164776, -0.2426918518689829}, { -0.19106084699559645, -0.41114541882058864}, { 0.02147447654085404, -0.539529539626976}, { 0.33208944882521496, -0.5447474061559614}, { 0.6377618708035405, -0.3515571837933962}, { 0.8099529265865586, 1.2280622261454005E-4}, { 0.7961442212036399, 0.42110959052258395}, { 0.5654601227144449, 0.8374673175913049}, { 0.0969615635145334, 1.1214488723370415}, { -0.5096517251395786, 1.114707082661801}, { -1.0532088375308903, 0.7771307501156299}, { -1.377907895717839, 0.1951840918877944}, { -1.3903552024409636, -0.5166255902649025}, { -1.019882815196987, -1.1929941270958426}, { -0.31411514825731407, -1.5995126579638925}, { 0.5125235396206947, -1.5823838773476733}, { 1.222713325570076, -1.161480769717913}, { 1.6518115099804418, -0.44206088589070913}, { 1.6696332651848973, 0.41963434549211115}, { 1.2342781275968788, 1.1729744372302011}, { 0.49220005487525786, 1.5789912186220854}, { -0.31297472189682685, 1.5635276265510811}, { -0.9880881285645149, 1.1782059978131298}, { -1.3789079582348587, 0.5201709988351368}, { -1.36812662174315, -0.2231247035075477}, { -0.9902624200645063, -0.8055566395595479}, { -0.42372057533300655, -1.084591058743713}, { 0.15937489385352738, -1.050289218615472}, { 0.6190508457855739, -0.7330850385521787}, { 0.802442061530244, -0.23659330183700417}, { 0.65492092774422, 0.21270695573762935}, { 0.32540447557301394, 0.41855930941186503}},
                {{ 0.20701280868082506, 0.046707514813063344}, { 0.13448752332972505, 0.14791284742894467}, { 0.02606474055314123, 0.17171225490006298}, { -0.053530928773642475, 0.13168518624452763}, { -0.08830541495421593, 0.0742547600979428}, { -0.09423607702902938, 0.020086878506872935}, { -0.07605376911201848, -0.02750609168227973}, { -0.037220757733805815, -0.05491928590315601}, { 0.003399676558456216, -0.05616460235821682}, { 0.036528386830764134, -0.04290380676320597}, { 0.06729193961957602, -0.015437885540729609}, { 0.08382322906259176, 0.03638895550613109}, { 0.06312018879773702, 0.09973970851380655}, { 0.004602512876680146, 0.14704118659565993}, { -0.07940025915164989, 0.1647892902311982}, { -0.18314482382509573, 0.13949658503412382}, { -0.28314750119997223, 0.04659431619355438}, { -0.32828352179805453, -0.11352706772264261}, { -0.2798635324599748, -0.30000659828650333}, { -0.1301407752150644, -0.4629297117493342}, { 0.11445354247937566, -0.5515545840696445}, { 0.4183758642098517, -0.5032195719759945}, { 0.6937133007273686, -0.2791328845437007}, { 0.83669560633118, 0.09174823224281223}, { 0.7779718455394004, 0.5283612446857645}, { 0.4883481169932463, 0.9254320951425962}, { -0.009791985222299838, 1.1547307325155922}, { -0.6091298980201775, 1.1006240423270646}, { -1.1391507298064847, 0.7306388590586727}, { -1.4396778723847874, 0.11305248272287341}, { -1.4023147132781189, -0.6160780072310796}, { -0.9890738842213952, -1.2710704169603384}, { -0.27291779317673404, -1.6506376719910236}, { 0.5594091078341468, -1.6234862070456213}, { 1.282998896018568, -1.18557520835225}, { 1.7085579772667174, -0.4414727487311471}, { 1.7145005859394655, 0.4250234380826696}, { 1.2888312271533238, 1.178464543647259}, { 0.5584429281744533, 1.6110117827409032}, { -0.263657895502965, 1.6275944386819425}, { -0.9648517852134095, 1.2539877717441659}, { -1.3755455211036802, 0.6064296188646126}, { -1.4027792254371148, -0.12516633302882682}, { -1.0760913982998295, -0.7283099808616258}, { -0.5340630864516814, -1.056015959991843}, { 0.048992454656507124, -1.0633715371733405}, { 0.5096629660422074, -0.7896077684032677}, { 0.7220114894844791, -0.3549386407004304}, { 0.6577071127619618, 0.059008092994157615}, { 0.4178998025082521, 0.30347763178879555}},
                {{ 0.18804845043097446, 0.03853351145942471}, { 0.13452274773944786, 0.12288815202686237}, { 0.04914317143108807, 0.15525561588439524}, { -0.02660560999853677, 0.13614628411156668}, { -0.07147744075830657, 0.08962988888631168}, { -0.08498094783959598, 0.03696977858940717}, { -0.0719763022139348, -0.00877913567640054}, { -0.04032019198216656, -0.03691294764460012}, { -0.0025297339825187948, -0.04266246374850441}, { 0.031623404605739994, -0.028546407482121866}, { 0.05612782886923606, 0.0037713901634278957}, { 0.0603755391842333, 0.052340959600589106}, { 0.032383503237623235, 0.10480918780220015}, { -0.029281929435081042, 0.1409825041981428}, { -0.11538266011401542, 0.1429892271362902}, { -0.20990761804212088, 0.09559240709143861}, { -0.28449259655389747, -0.011502239622011023}, { -0.3002852406075464, -0.1688538452241385}, { -0.22674940397360122, -0.34097318133796334}, { -0.055814426890349704, -0.47778112970918235}, { 0.19547876666469208, -0.5252195313660805}, { 0.4787790896979475, -0.43486805248639515}, { 0.7137008901969721, -0.18748806916223773}, { 0.8116987925493488, 0.1850982797428277}, { 0.7090262531742768, 0.6032776414737832}, { 0.3870405150715626, 0.9577233440967359}, { -0.11316808528812423, 1.130578602497128}, { -0.6831090634988961, 1.0314606872172791}, { -1.1696233257342539, 0.6402476448719746}, { -1.4240155242474128, 0.023563902370826628}, { -1.3463323123259394, -0.6803513385998602}, { -0.9166067943226686, -1.2908028808446845}, { -0.2156712531883286, -1.630352332963176}, { 0.5859729178562938, -1.5859845070799605}, { 1.280415790000778, -1.151163922154682}, { 1.6844885700153103, -0.4261270177308956}, { 1.6876041453329014, 0.40845099221499953}, { 1.2867353354850415, 1.135849380756912}, { 0.5945103927215418, 1.5690199947496017}, { -0.1988257653135786, 1.6109772973555971}, { -0.8884484273136904, 1.2753580632497916}, { -1.3088206724272606, 0.6726642519321459}, { -1.3749178205765369, -0.020698879781464504}, { -1.1076052066449869, -0.614671663750864}, { -0.6208552576570033, -0.9677719979183655}, { -0.07460566947574841, -1.0239360206510686}, { 0.3745288767796955, -0.8159856823353298}, { 0.615859825859532, -0.45227250207814135}, { 0.6238653349950856, -0.08005588565261489}, { 0.46563963541281167, 0.17987609729011464}}
        };
        Complex[][] cplx_res = UtilMethods.matToComplex(result);
        InverseContinuousWavelet icwt = new InverseContinuousWavelet(cplx_res, this.widths);
        double[] out = icwt.transform(InverseContinuousWavelet.waveletType.PAUL, 4.0);
        Assertions.assertArrayEquals(this.signal, out, 0.1);
    }
}
