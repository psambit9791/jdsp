package com.github.psambit9791.jdsp;

import com.github.psambit9791.jdsp.filter.adaptive.NLMS;
import com.github.psambit9791.jdsp.misc.Plotting;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Order;
import org.junit.jupiter.api.Test;

import java.io.File;
import java.io.IOException;
import java.util.Arrays;

public class TestAdaptiveFilterNLMS {
    // Random signal, with noise added
    private final double[] signal1 = {7.73615076e-01, -2.38644082e-01, -1.44153846e-02, -7.43728154e-02, 1.28832364e+00, -8.86944508e+00,  4.11744669e+00,  2.78178586e+00, -5.03828060e-01,  3.97897524e+00,  5.56136074e+00,  4.33681482e+00, 5.26247771e-01, -8.12778645e-01,  2.51919943e+00,  1.00856762e+00, 7.06685871e+00, -4.66127298e+00,  2.03547177e-01, -5.25186465e-01, -4.87098863e+00, -1.63898740e+00,  1.87870253e-01, -5.57965145e-01, -1.07066598e-01,  9.19816384e+00, -8.71136174e-01, -3.02327798e+00, -5.82031931e-02, -1.16211219e-01,  1.13151235e-01,  1.26114690e+00, 4.73462459e+00,  1.53611870e+00, -9.98205847e-01, -3.28775428e+00, 9.07053454e+00, -1.54833550e+00, -1.51008254e+00,  6.51624328e+00, -4.55701930e+00,  8.62041101e-01, -1.11631762e+00,  6.12632729e+00, 1.55095287e-01,  6.17289083e-01,  5.53387303e+00,  3.98012854e+00, -2.37425479e+00, -6.35874830e+00, -4.83330811e+00,  8.46856491e-01, -2.93207237e+00,  5.09877419e+00, -9.05449003e+00,  1.48636457e-01, -3.58520346e+00,  4.23115938e+00,  3.97121083e+00,  1.41538968e+00, -9.31974362e-01, -4.85514328e+00, -4.14552444e+00, -2.16680695e+00, 5.04741213e+00, -6.94276453e-02, -5.90503480e+00, -3.59451409e+00, 6.36499159e+00,  1.01308575e+01,  3.41732387e+00,  5.42015787e+00, 3.78165763e+00,  5.61407630e+00,  2.03656936e+00, -2.31467356e+00, 5.95036932e+00,  2.44526710e+00, -7.40024361e-01,  7.98213484e-02, -3.06403105e+00, -5.86909930e-01, -4.89830029e+00,  1.23679666e+01, 9.91312683e-02,  4.23599196e+00,  6.27245291e-01,  3.52968840e+00, 5.00869852e+00, -1.50513410e+00, -2.16011962e+00,  5.49917811e-01, -2.26659683e+00,  1.70725513e+00,  2.39727075e+00,  5.15351990e+00, 3.11771504e+00,  9.32193978e-01, -8.19075713e-02, -3.61008086e+00, -4.19740389e+00, -6.73014522e+00,  5.73541558e+00, -7.23020975e+00, -4.46432861e+00,  1.03575059e+01, -5.39284152e+00,  4.72954562e-02, 5.80744105e+00, -1.51942844e+00, -4.65530480e-01, -5.71813655e-01, 3.05234053e+00,  6.09075515e-01, -1.98037506e+00,  7.14506231e-01, 2.68107081e+00,  3.24380756e+00, -7.08060738e+00, -1.71634391e+00, 5.06864995e+00, -4.31711618e+00,  3.87541230e+00, -8.49148767e+00, 2.66471079e+00, -3.74045465e+00,  4.99362609e+00, -5.12173211e+00, -1.33151021e-01,  8.36393473e-01,  5.74386790e+00, -2.64544210e+00, 4.50639718e+00,  7.28226783e+00,  2.15130604e-01,  2.03331264e+00, -6.40605600e+00,  1.69201321e+00,  5.21920279e+00,  2.84600780e-01, 2.34699360e+00, -2.54902107e+00, -2.66004164e+00, -2.39064700e+00, -6.32328222e-01,  9.82091206e-01, -6.51881138e-02, -3.04311839e+00, -1.76498839e+00,  2.66959255e+00,  8.37398729e-01, -3.25932388e+00, 6.51018440e+00,  2.02981123e+00, -5.41678580e+00,  2.06063144e+00, -7.70799133e-01,  2.57805433e+00,  2.91215704e+00, -4.41207280e+00, -4.67975016e+00, -6.61825886e+00, -3.35400589e+00,  8.74674627e-03, 7.43617310e-01, -3.75279695e+00, -3.27974734e-01, -2.73018881e+00, -4.66419127e+00, -7.27015174e+00, -3.65824249e+00, -1.08689861e+01, -6.81145397e-01, -5.06373799e-01, -1.02286408e+00,  6.91061508e-01, -3.08047210e+00,  5.71097821e+00, -6.78346454e+00, -6.01614922e+00, -1.75321783e+00,  1.06042567e+00,  3.29761152e+00, -1.22316856e+01, 9.22934835e-01, -9.55571638e+00, -1.15720607e+00, -7.53973142e+00, 1.53614251e+00,  3.27826037e-01, -3.75613319e+00,  1.74610563e+00, 5.68450799e+00, -1.25439441e+00,  6.34719872e+00, -8.76148347e-02, -9.36224947e-01,  2.82739862e-01,  1.32286366e+00,  1.32513382e+00, 2.93519406e+00, -8.29501002e-02, -9.35219340e-01,  9.52288323e-01, 2.25459000e+00,  3.03397928e+00, -1.50991261e+00,  1.89007422e+00, 2.81578034e-01, -3.45521704e+00, -2.38102363e+00, -2.49901416e+00, 8.25811154e+00,  3.08093564e+00, -1.17275450e+00,  2.29109765e+00, 9.66588605e-01, -7.29614680e+00, -3.89862770e+00, -1.63177776e+00, 2.21062239e+00, -5.62142151e+00,  3.28703998e+00,  8.52994288e+00, -1.24469719e+01, -4.36683316e+00, -2.72106177e-02,  4.62359183e+00, 7.24635389e+00, -1.62475247e+00, -7.66715584e+00,  1.30017340e+00, -5.62427464e+00,  1.30661338e+00,  1.05783786e+00,  3.16697154e-01, -5.08342315e-01,  4.91503104e+00,  7.68950904e-01, -8.37960473e+00, -1.40923254e+00, -2.63983294e-01,  4.57667095e+00, -7.61954565e+00, -5.15705438e-01,  2.68324181e+00,  1.53501494e-01,  1.06547807e+00, -2.52481266e+00,  4.02400818e+00,  2.94278906e+00, -2.59587851e+00, 4.76356947e+00,  3.18790104e+00, -5.30617141e-01,  3.22259577e+00, 6.98506914e+00,  5.26638339e+00, -2.96500709e+00, -4.51119140e-01, 1.49355598e+00,  8.66748031e-01,  2.41373830e+00, -1.27962877e+01, -1.69749663e+00, -6.38403922e-01, -2.69025479e-02,  4.02110331e+00, -1.47302099e-01,  4.71460676e+00, -3.71553041e+00,  2.86150123e+00, 4.76119809e+00, -1.19943660e+01,  3.95721120e-01, -8.92553787e+00, -1.97728620e+00,  3.46256920e+00, -7.96185817e+00, -5.68217283e+00, 5.32929913e+00, -1.87257201e+00,  3.82966038e+00,  2.07931439e+00, -5.10278129e+00, -9.75036532e+00,  2.11412442e+00,  1.79136112e+00, 2.08851082e-01, -7.22878268e+00, -4.17436136e+00, -4.63950203e+00, -8.54334383e-01, -5.79718349e+00,  3.86479334e+00,  4.83305034e+00, -4.27911860e+00,  3.54769021e+00, -5.44921171e+00,  8.32057892e+00, -8.00431086e+00, -6.32228896e+00,  7.09907312e-01,  2.33025030e+00, 6.08993453e+00, -6.83040530e+00, -1.64226208e+00, -5.39967380e+00, 3.61227919e+00,  3.59240732e+00,  2.67544663e+00, -2.19368188e+00, 2.49938777e+00,  2.88113362e+00, -3.30686145e+00,  2.53345663e+00, 8.49847765e+00,  6.50954944e+00,  1.73708642e+00,  3.76887276e+00, -3.83969940e+00, -3.99288424e+00, -2.08440684e+00, -6.48882011e+00, -1.17096160e+00, -4.28469410e+00, -6.77145223e-01, -1.71511444e+00, 2.89530722e+00, -2.03556739e+00,  8.01652216e-01, -6.86940911e+00, -1.15869813e+00,  2.26229442e+00,  1.73180528e+00, -3.82690821e+00, -1.30215436e+00,  6.71157000e+00, -5.18619591e+00,  6.10730721e+00, 4.17824364e+00, -5.47350768e-01, -1.95091027e+00,  3.37065184e+00, -1.64087067e+00, -7.07230886e-01,  2.19743101e+00, -2.85092372e+00, 9.61000649e-02, -3.21997942e+00,  5.58314893e+00, -4.74336051e+00, 4.62330740e+00,  1.86626490e-01,  1.37941538e+01, -5.78476826e+00, -5.42956074e-01, -6.20485273e+00, -3.11219820e-01,  4.72771884e-01, -3.00272519e+00,  1.35757357e+01,  3.23723082e+00,  3.52392645e-01, 2.84983460e+00,  5.90285504e+00,  2.78295199e-01, -3.71991593e+00, 4.90393786e-01, -3.23339756e+00,  5.94712326e+00, -3.55754521e+00, 8.96638762e+00,  8.20815729e+00,  3.75698735e+00, -1.63676800e+00, -2.03287800e+00,  6.06536972e+00, -6.24905516e+00,  3.01720879e-02, 4.21378914e+00,  1.38184734e+00,  3.46479778e+00, -1.84767676e+00, -1.03990843e+01, -2.59162399e+00, -1.01643907e-01, -1.91403216e+00, 1.26809915e+00,  2.55410086e+00,  8.14394841e+00, -6.79178072e-02, 5.70672935e+00, -1.04381832e+01,  4.10828311e+00, -1.98631240e+00, 8.05464356e-01,  6.35907464e+00, -2.41284350e+00,  3.54715687e+00, 4.45992563e+00, -8.13578331e+00, -3.49508545e+00, -1.26504169e+00, -3.15447360e+00,  2.40131439e+00,  9.79161803e-01, -3.21828895e+00, 2.15796242e+00, -2.22399922e-02,  3.53969040e-01,  7.00018680e+00, -3.53066462e+00, -4.20977579e-01, -3.23784048e+00,  6.33446347e+00, -2.53304544e-01,  4.36525926e+00, -4.43411558e+00, -1.03541057e+01, 1.00582018e+00,  7.53986173e-01,  9.42740127e+00,  4.23075216e+00, -1.11933540e+00, -6.88447986e+00, -2.22444661e+00, -6.25773066e+00, 6.65462151e-01, -9.94164109e-01, -8.53134292e+00, -3.82421963e+00, 5.47933113e+00,  5.49597131e+00, -1.24903615e+00, -6.18754151e+00, 8.61059760e+00,  4.27719935e+00, -1.65472577e+00, -6.24315843e+00, 7.58833751e+00, -3.19055650e+00, -2.81457455e+00,  1.36777231e-01, 5.74597881e+00,  6.71414287e+00,  9.17304318e+00,  1.59196057e+00, 7.69328546e-01,  2.09118998e+00, -3.38710016e+00,  5.67221909e+00, 5.25098029e+00,  4.19042906e+00,  9.96586250e+00, -5.02617965e+00, -2.05694038e+00,  2.94181580e+00,  3.45276366e-01,  1.00680553e+00, 4.88756801e+00, -2.30546149e+00,  4.76144421e-02,  5.80800680e-01, 4.95026817e+00,  4.53184576e-01, -1.02612348e+00, -3.19471138e+00, -3.08277622e+00, -3.62541739e+00, -1.74932307e-01,  5.64901079e+00, 7.07411639e+00, -1.39018554e+00,  2.46724818e+00, -1.14596684e-01, -2.83008440e-01, -7.08167407e+00, -5.74811827e+00,  1.05915151e+00, 3.27010644e+00,  1.50217680e+00, -5.65604533e-01, -2.86155375e+00, -4.86212742e+00, -1.36804370e-01,  1.19991714e+00,  1.53118287e+00, -1.76843226e+00, -1.98751632e+00, -6.07251008e-02,  2.53082947e+00, -5.37658128e+00,  1.39249309e+00,  4.27613842e+00, -1.35429911e+00, -3.03972901e+00, -8.25716860e+00,  1.85549231e+00,  6.73101071e+00};
    // Random signal, without noise
    private final double[] desired1 = {6.20322971e-01, -4.09841098e-01, -9.80187866e-03, -1.70210263e-01, 1.28024248e+00, -8.93983098e+00,  4.04036826e+00,  2.73370133e+00, -4.33469505e-01,  4.07188976e+00,  5.59847799e+00,  4.23783257e+00, 5.90610898e-01, -7.43888978e-01,  2.54666415e+00,  9.48205572e-01, 7.13774466e+00, -4.61899113e+00, -1.08138482e-01, -4.60741262e-01, -5.06236290e+00, -1.57263124e+00,  1.72463013e-01, -4.38603977e-01, -1.16882719e-01,  9.10950241e+00, -8.85871541e-01, -2.91729735e+00, -5.55785313e-02, -1.27644735e-01,  1.87506586e-01,  1.28218283e+00, 4.73403185e+00,  1.67272470e+00, -8.42694444e-01, -3.22642166e+00, 9.04193863e+00, -1.39864440e+00, -1.39177059e+00,  6.58813300e+00, -4.67862696e+00,  8.76108291e-01, -1.19068484e+00,  6.11042607e+00, 1.79100980e-01,  6.27305024e-01,  5.48635552e+00,  4.10742392e+00, -2.54386792e+00, -6.28572995e+00, -5.01905644e+00,  8.85116304e-01, -3.02076280e+00,  5.18660457e+00, -9.04584478e+00,  1.73407095e-01, -3.68703140e+00,  4.16570237e+00,  3.99193257e+00,  1.47374667e+00, -6.39064738e-01, -4.83285745e+00, -4.04792069e+00, -2.32250034e+00, 4.91442294e+00, -1.04977123e-01, -6.02477757e+00, -3.44587416e+00, 6.32396972e+00,  1.02690757e+01,  3.56600212e+00,  5.42443584e+00, 3.83183761e+00,  5.60846635e+00,  2.09041306e+00, -2.26633937e+00, 5.93800436e+00,  2.49576410e+00, -5.67654734e-01,  1.51122971e-01, -3.03145109e+00, -5.74432978e-01, -4.99956761e+00,  1.22652369e+01, 1.31466921e-01,  4.09905285e+00,  5.50612531e-01,  3.65783953e+00, 5.20012149e+00, -1.67172970e+00, -1.99745466e+00,  5.28773982e-01, -2.26809734e+00,  1.69591397e+00,  2.50532516e+00,  4.99275225e+00, 3.16333140e+00,  8.37706959e-01, -2.48287184e-02, -3.45580122e+00, -4.19744562e+00, -6.69272971e+00,  5.77637076e+00, -7.31016910e+00, -4.31316467e+00,  1.05281527e+01, -5.32266318e+00,  5.46239994e-02, 5.76125167e+00, -1.58207746e+00, -2.94446822e-01, -4.30372151e-01, 3.04597438e+00,  4.51082462e-01, -2.26357625e+00,  6.06163565e-01, 2.66800877e+00,  3.38387646e+00, -7.14577300e+00, -1.66586237e+00, 5.19896805e+00, -4.30426255e+00,  3.86116751e+00, -8.62236402e+00, 2.54446326e+00, -3.69884469e+00,  4.97353534e+00, -5.10947898e+00, -1.37878793e-01,  9.02807877e-01,  5.66539916e+00, -2.67900017e+00, 4.69601540e+00,  7.20228922e+00,  1.86973061e-01,  1.97437397e+00, -6.36157787e+00,  1.79425245e+00,  5.16938162e+00,  2.41459346e-01, 2.31909544e+00, -2.49603769e+00, -2.73398117e+00, -2.42824300e+00, -8.69547609e-01,  8.43916705e-01, -7.64324894e-02, -2.95333197e+00, -1.73548082e+00,  2.55971571e+00,  6.97373108e-01, -3.24185587e+00, 6.34490404e+00,  2.13640391e+00, -5.41039618e+00,  1.89989943e+00, -8.67394519e-01,  2.50562320e+00,  2.83483779e+00, -4.56106610e+00, -4.76721641e+00, -6.68669902e+00, -3.42513446e+00,  1.21542409e-01, 7.54100091e-01, -3.85212268e+00, -3.61436895e-01, -2.81814452e+00, -4.69419194e+00, -7.18260082e+00, -3.63301542e+00, -1.06404260e+01, -6.43552654e-01, -5.97733250e-01, -9.41890005e-01,  7.99054630e-01, -2.97105540e+00,  5.60155411e+00, -6.79822829e+00, -5.90296803e+00, -1.92169072e+00,  1.01048399e+00,  3.15491775e+00, -1.23249426e+01, 8.21689120e-01, -9.43065940e+00, -1.18065987e+00, -7.62606697e+00, 1.43258193e+00,  3.41992754e-01, -3.75724675e+00,  1.88051307e+00, 5.73450966e+00, -1.39757419e+00,  6.28430065e+00,  1.93924165e-02, -9.98333216e-01,  4.56197080e-01,  1.21303472e+00,  1.38239515e+00, 2.84907250e+00, -1.33909614e-01, -8.25361175e-01,  9.39581607e-01, 2.33593522e+00,  3.08130834e+00, -1.43452604e+00,  1.80125539e+00, 2.59420594e-01, -3.41279177e+00, -2.46593092e+00, -2.33606415e+00, 8.18038873e+00,  3.05093528e+00, -1.27341041e+00,  2.07676684e+00, 1.14628046e+00, -7.31658070e+00, -3.94341918e+00, -1.65164926e+00, 2.35260878e+00, -5.71793217e+00,  3.35499677e+00,  8.48756405e+00, -1.25066389e+01, -4.31012734e+00,  7.16134396e-02,  4.57220153e+00, 7.16946897e+00, -1.74166204e+00, -7.55680546e+00,  1.24264780e+00, -5.80918771e+00,  1.44760859e+00,  9.20851910e-01,  3.94643207e-01, -4.89999450e-01,  4.94382258e+00,  7.10513376e-01, -8.34304559e+00, -1.57601053e+00, -2.05179519e-01,  4.73237195e+00, -7.53114293e+00, -7.17659446e-01,  2.58482091e+00,  1.34722002e-01,  1.11417180e+00, -2.53547793e+00,  3.97468674e+00,  3.00231909e+00, -2.47946333e+00, 4.74034007e+00,  3.26079402e+00, -7.88522215e-01,  3.12884483e+00, 6.95294325e+00,  5.21752677e+00, -2.93172727e+00, -3.49744085e-01, 1.54422289e+00,  8.04525484e-01,  2.26146149e+00, -1.27405913e+01, -1.88131431e+00, -5.73100193e-01, -4.57474561e-02,  3.90351981e+00, -1.18576368e-01,  4.71431915e+00, -3.71919014e+00,  2.85307890e+00, 4.80315050e+00, -1.19019226e+01,  4.45382640e-01, -8.82432455e+00, -1.98170017e+00,  3.62441513e+00, -7.90474719e+00, -5.73654223e+00, 5.21990963e+00, -1.85199232e+00,  3.69900823e+00,  1.98197679e+00, -5.07887258e+00, -9.81115406e+00,  2.02079279e+00,  1.78791361e+00, 2.16118872e-01, -7.24936608e+00, -4.21211606e+00, -4.55403775e+00, -8.20091648e-01, -5.81952610e+00,  4.11122554e+00,  4.85243351e+00, -4.16591809e+00,  3.49159211e+00, -5.58550581e+00,  8.24140327e+00, -8.03111184e+00, -6.37194978e+00,  8.43545930e-01,  2.31824619e+00, 6.13608142e+00, -6.83505342e+00, -1.68561751e+00, -5.39587420e+00, 3.78368434e+00,  3.51561246e+00,  2.75214568e+00, -2.29628260e+00, 2.45342513e+00,  2.88149194e+00, -3.27422394e+00,  2.68176949e+00, 8.49346939e+00,  6.42518788e+00,  1.80209062e+00,  3.73245577e+00, -3.81583124e+00, -4.00450649e+00, -2.27875252e+00, -6.43799020e+00, -1.11262480e+00, -4.19203362e+00, -4.97098946e-01, -1.83462482e+00, 2.94695796e+00, -1.99463789e+00,  7.59744017e-01, -6.82969849e+00, -1.10873344e+00,  2.14042603e+00,  1.75642756e+00, -3.91870664e+00, -1.36734001e+00,  6.53409552e+00, -5.23353200e+00,  6.08695015e+00, 4.23322932e+00, -5.47260775e-01, -2.10513908e+00,  3.45686665e+00, -1.65272933e+00, -6.58393827e-01,  2.29402463e+00, -2.70866324e+00, 2.92222764e-01, -3.22720329e+00,  5.61426137e+00, -4.85119662e+00, 4.72946742e+00,  6.81377454e-02,  1.36136286e+01, -5.70172966e+00, -5.95125726e-01, -6.12709200e+00, -2.70412355e-01,  3.09771619e-01, -3.27469313e+00,  1.34660755e+01,  3.23887997e+00,  2.30215012e-01, 2.78455846e+00,  5.75696096e+00,  2.95282995e-01, -3.71083334e+00, 4.42254523e-01, -3.09369103e+00,  6.09689476e+00, -3.50101849e+00, 8.78641050e+00,  8.09768828e+00,  3.79770038e+00, -1.69962376e+00, -2.08158714e+00,  6.15526646e+00, -6.19796768e+00,  1.61587531e-01, 4.17086821e+00,  1.51936988e+00,  3.40938465e+00, -1.69772761e+00, -1.03885009e+01, -2.67767496e+00, -2.64765858e-01, -1.94417939e+00, 1.24247588e+00,  2.63986706e+00,  8.13288936e+00, -1.11161005e-01, 5.81443310e+00, -1.04606658e+01,  4.05065893e+00, -1.92885151e+00, 7.56481535e-01,  6.42495485e+00, -2.47253521e+00,  3.52486095e+00, 4.47514333e+00, -8.17319595e+00, -3.49643060e+00, -1.18349449e+00, -3.11341342e+00,  2.44941138e+00,  9.15618759e-01, -3.13300598e+00, 2.22491866e+00,  7.82019270e-02,  2.81332457e-01,  6.98294094e+00, -3.46731123e+00, -4.81859091e-01, -3.26045272e+00,  6.52704405e+00, -5.81284424e-02,  4.48925332e+00, -4.34025706e+00, -1.04560308e+01, 1.05707641e+00,  7.18074513e-01,  9.32154408e+00,  4.17985157e+00, -1.10776889e+00, -6.93921542e+00, -2.27952655e+00, -6.17852651e+00, 6.79872800e-01, -9.70818301e-01, -8.52015568e+00, -3.89178994e+00, 5.34227394e+00,  5.52702778e+00, -1.29973981e+00, -6.38861974e+00, 8.57134087e+00,  4.16797756e+00, -1.58486075e+00, -6.19099590e+00, 7.63802682e+00, -3.25706066e+00, -2.74141940e+00,  1.68742209e-01, 5.70499335e+00,  6.66880913e+00,  9.26231400e+00,  1.54460016e+00, 7.99694193e-01,  2.19458568e+00, -3.19616589e+00,  5.83860640e+00, 5.34106257e+00,  4.03983792e+00,  9.89695766e+00, -5.08098837e+00, -1.89162539e+00,  2.87188401e+00,  3.83893003e-01,  1.01689223e+00, 4.79405529e+00, -2.26727908e+00,  8.74440507e-02,  4.55223192e-01, 5.07255592e+00,  2.44533574e-01, -1.08519920e+00, -3.09751435e+00, -3.20210200e+00, -3.59039080e+00, -3.04568346e-01,  5.63970837e+00, 6.84273908e+00, -1.47444271e+00,  2.31295604e+00, -1.54773058e-01, -3.24531580e-01, -7.14904049e+00, -5.66832695e+00,  9.70463546e-01, 3.33354510e+00,  1.66510437e+00, -5.51698118e-01, -2.94732077e+00, -4.98706127e+00, -2.07782880e-01,  1.27038141e+00,  1.54674194e+00, -1.67475274e+00, -1.91048324e+00, -4.66440356e-02,  2.57817830e+00, -5.19105666e+00,  1.53405872e+00,  4.24586382e+00, -1.25533117e+00, -2.98114393e+00, -8.14352980e+00,  1.92265397e+00,  6.63359396e+00};

    // Sine wave, with noise added
    private final double[] signal2 = {5.376671e-02,2.336831e-01,-1.254228e-01,2.365922e-01,2.317837e-01,1.181647e-01,2.539706e-01,3.792360e-01,7.495837e-01,7.144667e-01,3.472058e-01,8.291379e-01,6.403065e-01,6.021440e-01,7.190672e-01,6.646005e-01,7.084528e-01,9.037825e-01,9.277511e-01,9.586103e-01,9.120164e-01,7.499552e-01,9.660611e-01,1.078730e+00,9.836480e-01,1.054914e+00,1.038411e+00,9.472111e-01,1.016301e+00,9.150466e-01,1.086960e+00,8.852324e-01,8.923404e-01,9.150365e-01,6.957958e-01,1.125794e+00,1.003721e+00,8.824967e-01,1.079382e+00,7.531785e-01,8.937440e-01,8.571736e-01,8.883583e-01,8.606750e-01,7.137533e-01,7.660629e-01,7.194602e-01,7.637361e-01,7.735349e-01,7.366975e-01,4.993828e-01,5.519793e-01,3.799494e-01,3.458597e-01,4.112163e-01,5.188131e-01,2.413071e-01,3.073296e-01,1.988674e-01,2.838351e-01,1.343109e-02,7.552166e-02,7.726409e-02,8.176216e-02,7.588372e-02,-1.199842e-01,-3.274507e-01,-3.017849e-01,-3.824001e-01,-8.918407e-02,-4.329572e-01,-3.428165e-01,-4.820362e-01,-4.179320e-01,-6.259939e-01,-7.310609e-01,-7.729012e-01,-6.200775e-01,-7.231746e-01,-7.597970e-01,-6.311418e-01,-7.748387e-01,-8.131053e-01,-7.008977e-01,-9.647194e-01,-8.369773e-01,-8.432031e-01,-9.688099e-01,-9.382074e-01,-1.089265e+00,-1.097921e+00,-9.805945e-01,-9.243042e-01,-7.409058e-01,-1.066539e+00,-9.789821e-01,-1.001304e+00,-1.179183e+00,-1.020107e+00,-1.143538e+00,-8.654521e-01,-1.021309e+00,-9.031520e-01,-9.459586e-01,-8.372414e-01,-9.015180e-01,-7.642507e-01,-7.090143e-01,-5.794835e-01,-7.359063e-01,-8.943375e-01,-7.267465e-01,-4.679868e-01,-6.697930e-01,-4.241893e-01,-4.642701e-01,-2.881892e-01,-5.820396e-01,-3.588332e-01,-4.121035e-01,4.796362e-02,-1.112189e-01,-6.256733e-03,-2.000203e-01,-9.087366e-02,-2.095751e-02,1.664175e-01,7.893027e-02,2.267439e-01,8.840814e-04,2.196351e-01,2.209703e-01,1.931643e-01,4.483205e-01,4.713683e-01,4.910429e-01,3.976178e-01,6.856815e-01,6.484467e-01,6.224659e-01,6.919541e-01,6.990125e-01,5.839021e-01,7.621485e-01,7.373659e-01,7.502941e-01,7.581397e-01,8.437777e-01,7.179525e-01,1.033398e+00,1.005368e+00,9.653328e-01,9.753838e-01,9.080924e-01,1.096324e+00,9.851643e-01,9.285359e-01,1.134099e+00,9.729266e-01,9.304245e-01,9.513716e-01,8.848914e-01,8.441539e-01,1.192829e+00,1.087462e+00,9.320146e-01,7.526171e-01,7.666269e-01,8.082056e-01,8.755955e-01,6.318324e-01,4.986886e-01,5.515561e-01,6.928447e-01,6.599874e-01,6.258069e-01,5.259278e-01,5.142782e-01,4.039919e-01,4.923642e-01,2.235193e-01,3.578080e-01,1.792599e-01,1.817994e-01,2.211788e-01,2.200020e-01,-4.577237e-02,1.417889e-01,3.142910e-02,-9.159248e-02,-1.543341e-01,-2.062374e-01,-2.639855e-01,-2.799766e-01,-3.250440e-01,-2.946230e-01,-2.706330e-01,-4.216691e-01,-5.331763e-01,-4.922338e-01,-5.775739e-01,-7.385088e-01,-5.786367e-01,-6.791747e-01,-7.308886e-01,-7.255224e-01,-7.815805e-01,-9.304994e-01,-8.790973e-01,-9.017977e-01,-9.624765e-01,-7.608466e-01,-1.034060e+00,-1.009903e+00,-1.045322e+00,-1.101678e+00,-1.011124e+00,-1.024440e+00,-8.466355e-01,-1.024624e+00,-1.103692e+00,-8.319492e-01,-8.613398e-01,-9.977905e-01,-1.112996e+00,-9.919600e-01,-9.458098e-01,-8.829729e-01,-9.147552e-01,-8.201066e-01,-7.988812e-01,-9.346391e-01,-8.738187e-01,-8.206128e-01,-7.628740e-01,-7.079375e-01,-6.367100e-01,-9.013368e-01,-6.030680e-01,-3.906584e-01,-5.778068e-01,-3.328048e-01,-3.451077e-01,-3.360404e-01,-2.670513e-01,-3.932368e-01,-1.960206e-01,2.246730e-02,-7.810413e-02,-3.359053e-02,-6.083829e-02,5.977192e-02,1.362036e-01,2.054373e-01,1.749352e-01,2.374511e-01,5.116852e-01,1.309173e-01,6.262309e-01,4.825556e-01,5.931821e-01,3.698882e-01,5.190723e-01,5.905773e-01,6.993980e-01,5.271857e-01,7.766915e-01,6.417191e-01,8.011673e-01,8.893172e-01,8.842351e-01,9.850846e-01,1.000502e+00,8.555983e-01,9.648593e-01,8.608034e-01,8.367319e-01,1.072611e+00,9.888693e-01,9.896058e-01,1.089925e+00,1.059457e+00,1.033674e+00,1.119807e+00,1.081370e+00,1.003476e+00,8.990918e-01,8.891508e-01,1.057279e+00,7.582741e-01,8.960720e-01,6.804202e-01,9.519259e-01,9.084678e-01,7.927511e-01,7.538836e-01,4.787452e-01,7.500561e-01,4.355092e-01,3.839812e-01,5.835002e-01,4.387997e-01,5.315870e-01,5.136845e-01,4.861799e-01,2.846972e-01,3.512618e-01,2.681229e-01,2.917489e-01,2.133106e-01,1.996326e-01,4.652068e-02,-5.286073e-03,5.990714e-02,-3.034366e-01,-1.915000e-01,-3.177141e-01,-2.780439e-01,-2.234413e-01,-2.535305e-01,-4.845409e-01,-4.761273e-01,-4.602057e-01,-5.467829e-01,-5.297929e-01,-5.609425e-01,-7.333716e-01,-6.958774e-01,-9.275061e-01,-6.340548e-01,-8.438995e-01,-9.317982e-01,-8.651766e-01,-1.008890e+00,-8.921624e-01,-9.679415e-01,-7.135874e-01,-8.346516e-01,-1.212919e+00,-9.313915e-01,-1.125163e+00,-1.018185e+00,-9.810574e-01,-9.250177e-01,-1.026858e+00,-8.391564e-01,-1.039590e+00,-9.509449e-01,-9.069329e-01,-9.521337e-01,-8.573721e-01,-8.955677e-01,-9.863767e-01,-1.066274e+00,-6.754105e-01,-8.950758e-01,-7.955271e-01,-7.187470e-01,-7.309428e-01,-7.981351e-01,-7.180027e-01,-6.455900e-01,-4.454724e-01,-6.382152e-01,-4.310347e-01,-4.347174e-01,-4.438655e-01,-4.800123e-01,-3.556171e-01,-2.879319e-01,-3.775554e-01,-1.621669e-01,-2.139246e-01,-9.109616e-02,2.179143e-03,-7.159810e-02,4.030341e-02,1.542221e-01,-1.458509e-02,3.219557e-01,5.096087e-01,4.112310e-01,3.310440e-01,4.518959e-01,3.508123e-01,6.864242e-01,6.356729e-01,6.619310e-01,5.357267e-01,6.938492e-01,6.428896e-01,7.026724e-01,7.100532e-01,6.957782e-01,7.367536e-01,8.338202e-01,7.099416e-01,9.633792e-01,9.113458e-01,1.011212e+00,9.840477e-01,1.019876e+00,8.330441e-01,8.877543e-01,9.510005e-01,1.010065e+00,1.112843e+00,9.693119e-01,1.120275e+00,1.034959e+00,1.095625e+00,9.792283e-01,8.867262e-01,7.877314e-01,9.325149e-01,9.775949e-01,8.429874e-01,7.924662e-01,7.878367e-01,6.791252e-01,7.075708e-01,7.049692e-01,6.919686e-01,6.436076e-01,6.720757e-01,5.812838e-01,7.097197e-01,5.161495e-01,6.207980e-01,3.223234e-01,4.005782e-01,2.743058e-01,3.119923e-01,2.623805e-01,-6.511911e-02,-2.911415e-02,-9.066629e-02,4.332918e-02,9.986656e-02,-1.300139e-01,-6.603280e-02,-1.422709e-01,-3.510498e-01,-2.545792e-01,-4.172096e-01,-2.372220e-01,-4.379497e-01,-3.158372e-01,-5.654736e-01,-5.062312e-01,-6.122300e-01,-8.473893e-01,-7.810161e-01,-6.574330e-01,-7.582349e-01,-8.967762e-01,-8.777110e-01,-8.182284e-01,-9.684549e-01,-7.954308e-01,-9.785096e-01,-7.527505e-01,-1.058458e+00,-9.449820e-01,-1.128991e+00,-1.058765e+00,-1.052745e+00,-9.577891e-01,-9.056865e-01,-9.692975e-01,-1.033570e+00,-9.091091e-01,-9.026569e-01,-9.599257e-01,-9.017619e-01,-9.021205e-01,-1.024222e+00,-8.293517e-01,-9.485200e-01,-9.184487e-01,-8.134472e-01,-8.328735e-01,-7.842562e-01,-6.785378e-01,-5.985214e-01,-6.863518e-01,-5.954522e-01,-6.121241e-01,-5.239192e-01,-4.600798e-01,-5.216909e-01,-3.872811e-01,-3.083652e-01,-3.120225e-01,-1.002340e-01,-2.853472e-01,-2.489024e-01,-3.004460e-01,1.564619e-02,6.155301e-02,1.716596e-02,1.652497e-01,1.438284e-01,2.042755e-01,2.357859e-01,3.172134e-01,3.314196e-01,6.472089e-01,2.980983e-01,2.745744e-01,3.900114e-01,4.375445e-01,5.449330e-01,6.113730e-01,6.447026e-01,7.573381e-01,7.770002e-01,8.461971e-01,9.799488e-01,9.534481e-01,7.297312e-01,6.499045e-01,9.955016e-01,7.419618e-01,9.500758e-01,9.624346e-01,1.194663e+00,9.756242e-01,9.399257e-01,1.019844e+00,1.023927e+00,1.006904e+00,9.370647e-01,8.711603e-01,1.018052e+00,8.426010e-01,8.616825e-01,1.083593e+00,8.917464e-01,9.004064e-01,9.829081e-01,8.391419e-01,9.461167e-01,7.805665e-01,8.861832e-01,8.156797e-01,6.973826e-01,5.962332e-01,5.408826e-01,5.789440e-01,5.213604e-01,4.821003e-01,5.777917e-01,4.049234e-01,5.032166e-01,2.888581e-01,3.915824e-01,1.936615e-01,2.144827e-01,2.443389e-01,5.593529e-02,3.326518e-03,1.971943e-01,4.166428e-02,-1.467905e-01,-8.858898e-02,-2.389951e-01,-1.813896e-01,-1.587460e-01,-5.083751e-01,-2.917502e-01,-2.945518e-01,-4.802000e-01,-3.536925e-01,-5.548132e-01,-7.346541e-01,-8.693354e-01,-7.207252e-01,-6.516889e-01,-7.251310e-01,-7.474235e-01,-8.764094e-01,-8.321447e-01,-1.036113e+00,-9.717487e-01,-9.988453e-01,-8.838984e-01,-9.538238e-01,-1.082087e+00,-9.791654e-01,-1.056397e+00,-1.060790e+00,-9.118932e-01,-9.886272e-01,-9.592627e-01,-9.073030e-01,-9.717549e-01,-9.262707e-01,-9.021513e-01,-8.400220e-01,-8.937094e-01,-7.819023e-01,-9.003583e-01,-8.846149e-01,-6.846764e-01,-8.785993e-01,-7.986370e-01,-6.750675e-01,-7.188345e-01,-5.582257e-01,-5.584421e-01,-5.941571e-01,-6.609663e-01,-4.849329e-01,-6.368998e-01,-4.299633e-01,-3.281898e-01,-3.413170e-01,-2.273232e-01,-6.327499e-02,-1.259648e-01,-1.423091e-01,-5.504966e-02,-2.658051e-02,-1.503397e-01,-1.019893e-02,2.041409e-01,1.273369e-01,2.396275e-01,1.299659e-01,2.857146e-01,3.872322e-01,2.381635e-01,4.552388e-01,4.473954e-01,4.155480e-01,5.483803e-01,4.037378e-01,4.203033e-01,5.535389e-01,6.086093e-01,6.249993e-01,6.025209e-01,8.346859e-01,6.752044e-01,8.722917e-01,9.644436e-01,9.077394e-01,9.371999e-01,9.076517e-01,8.123850e-01,9.690244e-01,1.079779e+00,1.165321e+00,9.537658e-01,8.368215e-01,1.016426e+00,1.035124e+00,9.699846e-01,8.704577e-01,1.177957e+00,7.272778e-01,8.975009e-01,7.992027e-01,8.482622e-01,9.218618e-01,8.798302e-01,7.687086e-01,8.891135e-01,8.432299e-01,8.133290e-01,6.717335e-01,7.830524e-01,7.064461e-01,8.518129e-01,6.663208e-01,6.332887e-01,4.792061e-01,3.001818e-01,3.459244e-01,2.603241e-01,2.319123e-01,2.952992e-01,1.349768e-01,5.153002e-02,5.013825e-02,2.478152e-02,3.149937e-02,-1.549781e-01,-7.811196e-02,-1.518929e-01,-7.670339e-02,-2.793766e-01,-3.197719e-01,-4.709487e-01,-5.389329e-01,-4.149359e-01,-5.153868e-01,-4.832734e-01,-6.647730e-01,-4.250580e-01,-6.425296e-01,-5.872355e-01,-7.500657e-01,-7.772175e-01,-7.236297e-01,-7.667205e-01,-9.619016e-01,-1.028574e+00,-1.008305e+00,-1.061034e+00,-9.321118e-01,-9.954312e-01,-1.004929e+00,-1.115596e+00,-9.104346e-01,-9.508406e-01,-1.007616e+00,-8.978808e-01,-1.086210e+00,-9.536276e-01,-9.540202e-01,-9.452025e-01,-1.041836e+00,-9.225571e-01,-9.906418e-01,-1.010334e+00,-1.020221e+00,-7.730397e-01,-9.361236e-01,-8.413730e-01,-9.154135e-01,-7.927165e-01,-1.052732e+00,-8.029017e-01,-7.997700e-01,-7.198288e-01,-5.994025e-01,-5.688394e-01,-2.987363e-01,-5.059765e-01,-4.282896e-01,-5.136842e-01,-3.570543e-01,-3.948942e-01,-2.091862e-01,-7.748984e-02,-7.254352e-02,-1.329153e-01,-1.756329e-01,1.837292e-01,2.929432e-01,1.499774e-01,8.857649e-02,3.565084e-01,2.260309e-01,2.861589e-01,4.687775e-01,2.876556e-01,2.754613e-01,5.569717e-01,5.974404e-01,6.079333e-01,6.876253e-01,7.841040e-01,8.091371e-01,6.896452e-01,8.600198e-01,8.268959e-01,7.875163e-01,7.451182e-01,9.533360e-01,8.752174e-01,9.348592e-01,8.682025e-01,8.073291e-01,9.919865e-01,9.785938e-01,1.112198e+00,1.077441e+00,1.105052e+00,9.247551e-01,9.034008e-01,8.649918e-01,1.034055e+00,1.253030e+00,1.034279e+00,8.691806e-01,1.012720e+00,7.964423e-01,7.447453e-01,9.346078e-01,7.585603e-01,8.393197e-01,9.177005e-01,7.845185e-01,8.028469e-01,5.129787e-01,7.016857e-01,8.097468e-01,6.088668e-01,3.581172e-01,4.480463e-01,3.733341e-01,4.155317e-01,3.713766e-01,3.228304e-01,1.972966e-01,1.245496e-01,7.585308e-02,1.701600e-01,-1.507156e-01,-3.645336e-02,-3.895367e-02,-1.813700e-01,-1.181778e-01,-2.224201e-01,-3.579610e-01,-2.961687e-01,-3.865070e-01,-4.471493e-01,-5.227395e-01,-4.897648e-01,-7.235691e-01,-6.204723e-01,-6.752068e-01,-7.506834e-01,-6.311960e-01,-8.051025e-01,-7.109695e-01,-6.988698e-01,-8.415460e-01,-8.253938e-01,-8.143772e-01,-9.093588e-01,-8.678249e-01,-1.066486e+00,-8.451244e-01,-1.068640e+00,-1.163631e+00,-8.508775e-01,-1.001676e+00,-9.540684e-01,-1.036315e+00,-1.100544e+00,-1.301755e+00,-9.252808e-01,-1.007529e+00,-9.870698e-01,-9.128011e-01,-1.078910e+00,-9.911606e-01,-7.824006e-01,-8.139934e-01,-9.763428e-01,-1.040829e+00,-8.478383e-01,-7.375236e-01,-6.309743e-01,-6.802925e-01,-7.646037e-01,-5.828130e-01,-6.901657e-01,-6.270823e-01,-5.530684e-01,-5.661092e-01,-4.246196e-01,-4.408651e-01,-3.318976e-01,-3.012622e-01,-2.470442e-01,-2.069437e-01,1.661225e-02,4.455473e-03,-3.822178e-04,-1.026826e-01,-6.837809e-02,-5.232131e-02,4.542603e-01,3.400747e-01,3.170171e-01,2.416393e-01,2.713131e-01,4.866228e-01,6.331834e-01,3.509503e-01,5.176377e-01,5.950170e-01,4.435879e-01,7.646266e-01,6.750280e-01,9.418904e-01,7.438608e-01,8.541654e-01,7.272425e-01,8.051071e-01,7.746334e-01,9.524189e-01,1.062690e+00,8.901255e-01,1.007708e+00,9.257746e-01,9.960912e-01,1.112680e+00,1.009743e+00,8.961661e-01,9.137446e-01,9.795422e-01,9.719151e-01,8.965442e-01,9.907475e-01,1.086427e+00,9.193215e-01,9.062549e-01,6.864876e-01,8.068215e-01,7.203403e-01,7.942630e-01,8.565558e-01,9.253997e-01,9.200411e-01,6.937486e-01,6.368773e-01,7.124152e-01,6.398500e-01,6.260341e-01,5.846209e-01,3.147638e-01,4.716606e-01,3.622431e-01,2.482046e-01,2.068823e-01,3.557005e-01,9.731791e-02,4.895460e-03,1.000061e-01,2.293760e-01,-1.945594e-02,-4.143597e-02,-2.161622e-01,-4.677888e-03,-2.089270e-01,-2.171816e-01,-4.134805e-01,-2.801458e-01,-3.729867e-01,-5.728099e-01,-4.973871e-01,-5.893032e-01,-5.748233e-01,-6.508255e-01,-6.831985e-01,-8.042567e-01,-7.682773e-01,-6.924153e-01,-6.257740e-01,-9.454411e-01,-6.186964e-01,-7.287105e-01,-8.871175e-01,-9.544508e-01,-1.012218e+00,-8.747125e-01,-1.040662e+00,-1.028144e+00,-9.018625e-01,-9.523919e-01,-9.095528e-01,-9.494662e-01,-1.038210e+00,-1.045160e+00,-9.072773e-01,-1.044674e+00,-8.470561e-01,-8.723743e-01,-9.059865e-01,-9.153842e-01,-8.577755e-01,-5.180361e-01,-8.561104e-01,-9.725504e-01,-5.953375e-01,-6.938281e-01,-7.856584e-01,-4.233636e-01,-5.924978e-01,-5.790292e-01,-6.455505e-01,-6.321386e-01,-6.590359e-01,-4.798150e-01,-4.970543e-01,-2.801980e-01,-3.290927e-01,-7.203440e-02,-4.884895e-02,-1.339738e-01,-1.287382e-01,6.492201e-02,-1.146508e-01};
    // Sine wave, without noise
    private final double[] desired2 = {0,5.029457e-02,1.004618e-01,1.503748e-01,1.999072e-01,2.489336e-01,2.973298e-01,3.449735e-01,3.917441e-01,4.375230e-01,4.821945e-01,5.256456e-01,5.677661e-01,6.084495e-01,6.475929e-01,6.850971e-01,7.208672e-01,7.548127e-01,7.868477e-01,8.168910e-01,8.448667e-01,8.707039e-01,8.943372e-01,9.157068e-01,9.347587e-01,9.514445e-01,9.657220e-01,9.775552e-01,9.869141e-01,9.937749e-01,9.981204e-01,9.999394e-01,9.992275e-01,9.959864e-01,9.902243e-01,9.819557e-01,9.712018e-01,9.579895e-01,9.423525e-01,9.243302e-01,9.039683e-01,8.813183e-01,8.564376e-01,8.293891e-01,8.002413e-01,7.690680e-01,7.359481e-01,7.009653e-01,6.642084e-01,6.257702e-01,5.857481e-01,5.442434e-01,5.013611e-01,4.572098e-01,4.119012e-01,3.655501e-01,3.182737e-01,2.701917e-01,2.214258e-01,1.720995e-01,1.223375e-01,7.226591e-02,2.201138e-02,-2.829886e-02,-7.853747e-02,-1.285773e-01,-1.782917e-01,-2.275548e-01,-2.762419e-01,-3.242298e-01,-3.713970e-01,-4.176242e-01,-4.627943e-01,-5.067930e-01,-5.495090e-01,-5.908340e-01,-6.306636e-01,-6.688969e-01,-7.054371e-01,-7.401917e-01,-7.730728e-01,-8.039971e-01,-8.328864e-01,-8.596676e-01,-8.842728e-01,-9.066398e-01,-9.267119e-01,-9.444384e-01,-9.597744e-01,-9.726811e-01,-9.831257e-01,-9.910819e-01,-9.965296e-01,-9.994549e-01,-9.998504e-01,-9.977152e-01,-9.930546e-01,-9.858804e-01,-9.762109e-01,-9.640703e-01,-9.494896e-01,-9.325056e-01,-9.131613e-01,-8.915057e-01,-8.675935e-01,-8.414853e-01,-8.132472e-01,-7.829506e-01,-7.506723e-01,-7.164939e-01,-6.805020e-01,-6.427876e-01,-6.034462e-01,-5.625775e-01,-5.202847e-01,-4.766750e-01,-4.318589e-01,-3.859496e-01,-3.390634e-01,-2.913190e-01,-2.428372e-01,-1.937408e-01,-1.441539e-01,-9.420224e-02,-4.401210e-02,6.289433e-03,5.657505e-02,1.067175e-01,1.565898e-01,2.060657e-01,2.550201e-01,3.033289e-01,3.508701e-01,3.975231e-01,4.431699e-01,4.876949e-01,5.309856e-01,5.729323e-01,6.134287e-01,6.523725e-01,6.896651e-01,7.252120e-01,7.589233e-01,7.907136e-01,8.205026e-01,8.482147e-01,8.737799e-01,8.971334e-01,9.182161e-01,9.369747e-01,9.533617e-01,9.673355e-01,9.788610e-01,9.879087e-01,9.944560e-01,9.984861e-01,9.999889e-01,9.989606e-01,9.954037e-01,9.893274e-01,9.807469e-01,9.696840e-01,9.561667e-01,9.402292e-01,9.219119e-01,9.012610e-01,8.783290e-01,8.531737e-01,8.258590e-01,7.964539e-01,7.650328e-01,7.316753e-01,6.964659e-01,6.594936e-01,6.208520e-01,5.806389e-01,5.389562e-01,4.959093e-01,4.516072e-01,4.061620e-01,3.596887e-01,3.123050e-01,2.641309e-01,2.152881e-01,1.659005e-01,1.160929e-01,6.599149e-02,1.572304e-02,-3.458521e-02,-8.480592e-02,-1.348120e-01,-1.844768e-01,-2.336747e-01,-2.822811e-01,-3.301731e-01,-3.772293e-01,-4.233307e-01,-4.683605e-01,-5.122049e-01,-5.547529e-01,-5.958966e-01,-6.355321e-01,-6.735589e-01,-7.098809e-01,-7.444060e-01,-7.770470e-01,-8.077211e-01,-8.363508e-01,-8.628636e-01,-8.871923e-01,-9.092754e-01,-9.290570e-01,-9.464870e-01,-9.615213e-01,-9.741219e-01,-9.842568e-01,-9.919004e-01,-9.970334e-01,-9.996428e-01,-9.997219e-01,-9.972705e-01,-9.922950e-01,-9.848078e-01,-9.748278e-01,-9.623805e-01,-9.474972e-01,-9.302157e-01,-9.105797e-01,-8.886389e-01,-8.644488e-01,-8.380706e-01,-8.095712e-01,-7.790226e-01,-7.465022e-01,-7.120923e-01,-6.758800e-01,-6.379569e-01,-5.984191e-01,-5.573666e-01,-5.149033e-01,-4.711367e-01,-4.261776e-01,-3.801398e-01,-3.331398e-01,-2.852966e-01,-2.367312e-01,-1.875667e-01,-1.379273e-01,-8.793891e-02,-3.772789e-02,1.257862e-02,6.285329e-02,1.129689e-01,1.627985e-01,2.122161e-01,2.610965e-01,3.093161e-01,3.567527e-01,4.032863e-01,4.487992e-01,4.931761e-01,5.363046e-01,5.780758e-01,6.183837e-01,6.571264e-01,6.942058e-01,7.295281e-01,7.630038e-01,7.945483e-01,8.240817e-01,8.515291e-01,8.768213e-01,8.998941e-01,9.206891e-01,9.391537e-01,9.552412e-01,9.689108e-01,9.801280e-01,9.888643e-01,9.950976e-01,9.988123e-01,9.999988e-01,9.986541e-01,9.947817e-01,9.883914e-01,9.794993e-01,9.681280e-01,9.543061e-01,9.380688e-01,9.194571e-01,8.985182e-01,8.753049e-01,8.498761e-01,8.222962e-01,7.926349e-01,7.609673e-01,7.273736e-01,6.919389e-01,6.547527e-01,6.159093e-01,5.755069e-01,5.336478e-01,4.904379e-01,4.459867e-01,4.004067e-01,3.538131e-01,3.063240e-01,2.580596e-01,2.091419e-01,1.596949e-01,1.098437e-01,5.971446e-02,9.434072e-03,-4.087020e-02,-9.107102e-02,-1.410413e-01,-1.906546e-01,-2.397854e-01,-2.883092e-01,-3.361032e-01,-3.830466e-01,-4.290204e-01,-4.739082e-01,-5.175966e-01,-5.599748e-01,-6.009356e-01,-6.403754e-01,-6.781943e-01,-7.142966e-01,-7.485909e-01,-7.809905e-01,-8.114132e-01,-8.397821e-01,-8.660254e-01,-8.900767e-01,-9.118750e-01,-9.313653e-01,-9.484981e-01,-9.632302e-01,-9.755242e-01,-9.853490e-01,-9.926797e-01,-9.974978e-01,-9.997911e-01,-9.995538e-01,-9.967864e-01,-9.914961e-01,-9.836961e-01,-9.734063e-01,-9.606526e-01,-9.454674e-01,-9.278890e-01,-9.079621e-01,-8.857369e-01,-8.612698e-01,-8.346227e-01,-8.058631e-01,-7.750637e-01,-7.423025e-01,-7.076625e-01,-6.712312e-01,-6.331010e-01,-5.933683e-01,-5.521336e-01,-5.095015e-01,-4.655797e-01,-4.204795e-01,-3.743150e-01,-3.272030e-01,-2.792629e-01,-2.306159e-01,-1.813851e-01,-1.316953e-01,-8.167210e-02,-3.144219e-02,1.886730e-02,6.912904e-02,1.192158e-01,1.690008e-01,2.183581e-01,2.671626e-01,3.152909e-01,3.626212e-01,4.090336e-01,4.544107e-01,4.986377e-01,5.416025e-01,5.831964e-01,6.233142e-01,6.618542e-01,6.987191e-01,7.338153e-01,7.670542e-01,7.983515e-01,8.276281e-01,8.548099e-01,8.798280e-01,9.026191e-01,9.231256e-01,9.412955e-01,9.570829e-01,9.704477e-01,9.813562e-01,9.897807e-01,9.957000e-01,9.990990e-01,9.999691e-01,9.983082e-01,9.941204e-01,9.874163e-01,9.782129e-01,9.665336e-01,9.524078e-01,9.358713e-01,9.169660e-01,8.957397e-01,8.722462e-01,8.465449e-01,8.187009e-01,7.887846e-01,7.568718e-01,7.230432e-01,6.873845e-01,6.499859e-01,6.109421e-01,5.703520e-01,5.283182e-01,4.849471e-01,4.403486e-01,3.946355e-01,3.479235e-01,3.003309e-01,2.519781e-01,2.029875e-01,1.534831e-01,1.035902e-01,5.343507e-02,3.144732e-03,-4.715357e-02,-9.733252e-02,-1.472651e-01,-1.968249e-01,-2.458866e-01,-2.943259e-01,-3.420201e-01,-3.888487e-01,-4.346931e-01,-4.794372e-01,-5.229677e-01,-5.651746e-01,-6.059509e-01,-6.451934e-01,-6.828029e-01,-7.186841e-01,-7.527462e-01,-7.849030e-01,-8.150731e-01,-8.431802e-01,-8.691530e-01,-8.929259e-01,-9.144386e-01,-9.336368e-01,-9.504718e-01,-9.649010e-01,-9.768879e-01,-9.864021e-01,-9.934197e-01,-9.979227e-01,-9.998999e-01,-9.993461e-01,-9.962629e-01,-9.906580e-01,-9.825456e-01,-9.719462e-01,-9.588867e-01,-9.434001e-01,-9.255256e-01,-9.053085e-01,-8.827999e-01,-8.580568e-01,-8.311419e-01,-8.021232e-01,-7.710742e-01,-7.380735e-01,-7.032047e-01,-6.665559e-01,-6.282200e-01,-5.882940e-01,-5.468789e-01,-5.040796e-01,-4.600043e-01,-4.147648e-01,-3.684754e-01,-3.212533e-01,-2.732182e-01,-2.244914e-01,-1.751964e-01,-1.254580e-01,-7.540206e-02,-2.515525e-02,2.515525e-02,7.540206e-02,1.254580e-01,1.751964e-01,2.244914e-01,2.732182e-01,3.212533e-01,3.684754e-01,4.147648e-01,4.600043e-01,5.040796e-01,5.468789e-01,5.882940e-01,6.282200e-01,6.665559e-01,7.032047e-01,7.380735e-01,7.710742e-01,8.021232e-01,8.311419e-01,8.580568e-01,8.827999e-01,9.053085e-01,9.255256e-01,9.434001e-01,9.588867e-01,9.719462e-01,9.825456e-01,9.906580e-01,9.962629e-01,9.993461e-01,9.998999e-01,9.979227e-01,9.934197e-01,9.864021e-01,9.768879e-01,9.649010e-01,9.504718e-01,9.336368e-01,9.144386e-01,8.929259e-01,8.691530e-01,8.431802e-01,8.150731e-01,7.849030e-01,7.527462e-01,7.186841e-01,6.828029e-01,6.451934e-01,6.059509e-01,5.651746e-01,5.229677e-01,4.794372e-01,4.346931e-01,3.888487e-01,3.420201e-01,2.943259e-01,2.458866e-01,1.968249e-01,1.472651e-01,9.733252e-02,4.715357e-02,-3.144732e-03,-5.343507e-02,-1.035902e-01,-1.534831e-01,-2.029875e-01,-2.519781e-01,-3.003309e-01,-3.479235e-01,-3.946355e-01,-4.403486e-01,-4.849471e-01,-5.283182e-01,-5.703520e-01,-6.109421e-01,-6.499859e-01,-6.873845e-01,-7.230432e-01,-7.568718e-01,-7.887846e-01,-8.187009e-01,-8.465449e-01,-8.722462e-01,-8.957397e-01,-9.169660e-01,-9.358713e-01,-9.524078e-01,-9.665336e-01,-9.782129e-01,-9.874163e-01,-9.941204e-01,-9.983082e-01,-9.999691e-01,-9.990990e-01,-9.957000e-01,-9.897807e-01,-9.813562e-01,-9.704477e-01,-9.570829e-01,-9.412955e-01,-9.231256e-01,-9.026191e-01,-8.798280e-01,-8.548099e-01,-8.276281e-01,-7.983515e-01,-7.670542e-01,-7.338153e-01,-6.987191e-01,-6.618542e-01,-6.233142e-01,-5.831964e-01,-5.416025e-01,-4.986377e-01,-4.544107e-01,-4.090336e-01,-3.626212e-01,-3.152909e-01,-2.671626e-01,-2.183581e-01,-1.690008e-01,-1.192158e-01,-6.912904e-02,-1.886730e-02,3.144219e-02,8.167210e-02,1.316953e-01,1.813851e-01,2.306159e-01,2.792629e-01,3.272030e-01,3.743150e-01,4.204795e-01,4.655797e-01,5.095015e-01,5.521336e-01,5.933683e-01,6.331010e-01,6.712312e-01,7.076625e-01,7.423025e-01,7.750637e-01,8.058631e-01,8.346227e-01,8.612698e-01,8.857369e-01,9.079621e-01,9.278890e-01,9.454674e-01,9.606526e-01,9.734063e-01,9.836961e-01,9.914961e-01,9.967864e-01,9.995538e-01,9.997911e-01,9.974978e-01,9.926797e-01,9.853490e-01,9.755242e-01,9.632302e-01,9.484981e-01,9.313653e-01,9.118750e-01,8.900767e-01,8.660254e-01,8.397821e-01,8.114132e-01,7.809905e-01,7.485909e-01,7.142966e-01,6.781943e-01,6.403754e-01,6.009356e-01,5.599748e-01,5.175966e-01,4.739082e-01,4.290204e-01,3.830466e-01,3.361032e-01,2.883092e-01,2.397854e-01,1.906546e-01,1.410413e-01,9.107102e-02,4.087020e-02,-9.434072e-03,-5.971446e-02,-1.098437e-01,-1.596949e-01,-2.091419e-01,-2.580596e-01,-3.063240e-01,-3.538131e-01,-4.004067e-01,-4.459867e-01,-4.904379e-01,-5.336478e-01,-5.755069e-01,-6.159093e-01,-6.547527e-01,-6.919389e-01,-7.273736e-01,-7.609673e-01,-7.926349e-01,-8.222962e-01,-8.498761e-01,-8.753049e-01,-8.985182e-01,-9.194571e-01,-9.380688e-01,-9.543061e-01,-9.681280e-01,-9.794993e-01,-9.883914e-01,-9.947817e-01,-9.986541e-01,-9.999988e-01,-9.988123e-01,-9.950976e-01,-9.888643e-01,-9.801280e-01,-9.689108e-01,-9.552412e-01,-9.391537e-01,-9.206891e-01,-8.998941e-01,-8.768213e-01,-8.515291e-01,-8.240817e-01,-7.945483e-01,-7.630038e-01,-7.295281e-01,-6.942058e-01,-6.571264e-01,-6.183837e-01,-5.780758e-01,-5.363046e-01,-4.931761e-01,-4.487992e-01,-4.032863e-01,-3.567527e-01,-3.093161e-01,-2.610965e-01,-2.122161e-01,-1.627985e-01,-1.129689e-01,-6.285329e-02,-1.257862e-02,3.772789e-02,8.793891e-02,1.379273e-01,1.875667e-01,2.367312e-01,2.852966e-01,3.331398e-01,3.801398e-01,4.261776e-01,4.711367e-01,5.149033e-01,5.573666e-01,5.984191e-01,6.379569e-01,6.758800e-01,7.120923e-01,7.465022e-01,7.790226e-01,8.095712e-01,8.380706e-01,8.644488e-01,8.886389e-01,9.105797e-01,9.302157e-01,9.474972e-01,9.623805e-01,9.748278e-01,9.848078e-01,9.922950e-01,9.972705e-01,9.997219e-01,9.996428e-01,9.970334e-01,9.919004e-01,9.842568e-01,9.741219e-01,9.615213e-01,9.464870e-01,9.290570e-01,9.092754e-01,8.871923e-01,8.628636e-01,8.363508e-01,8.077211e-01,7.770470e-01,7.444060e-01,7.098809e-01,6.735589e-01,6.355321e-01,5.958966e-01,5.547529e-01,5.122049e-01,4.683605e-01,4.233307e-01,3.772293e-01,3.301731e-01,2.822811e-01,2.336747e-01,1.844768e-01,1.348120e-01,8.480592e-02,3.458521e-02,-1.572304e-02,-6.599149e-02,-1.160929e-01,-1.659005e-01,-2.152881e-01,-2.641309e-01,-3.123050e-01,-3.596887e-01,-4.061620e-01,-4.516072e-01,-4.959093e-01,-5.389562e-01,-5.806389e-01,-6.208520e-01,-6.594936e-01,-6.964659e-01,-7.316753e-01,-7.650328e-01,-7.964539e-01,-8.258590e-01,-8.531737e-01,-8.783290e-01,-9.012610e-01,-9.219119e-01,-9.402292e-01,-9.561667e-01,-9.696840e-01,-9.807469e-01,-9.893274e-01,-9.954037e-01,-9.989606e-01,-9.999889e-01,-9.984861e-01,-9.944560e-01,-9.879087e-01,-9.788610e-01,-9.673355e-01,-9.533617e-01,-9.369747e-01,-9.182161e-01,-8.971334e-01,-8.737799e-01,-8.482147e-01,-8.205026e-01,-7.907136e-01,-7.589233e-01,-7.252120e-01,-6.896651e-01,-6.523725e-01,-6.134287e-01,-5.729323e-01,-5.309856e-01,-4.876949e-01,-4.431699e-01,-3.975231e-01,-3.508701e-01,-3.033289e-01,-2.550201e-01,-2.060657e-01,-1.565898e-01,-1.067175e-01,-5.657505e-02,-6.289433e-03,4.401210e-02,9.420224e-02,1.441539e-01,1.937408e-01,2.428372e-01,2.913190e-01,3.390634e-01,3.859496e-01,4.318589e-01,4.766750e-01,5.202847e-01,5.625775e-01,6.034462e-01,6.427876e-01,6.805020e-01,7.164939e-01,7.506723e-01,7.829506e-01,8.132472e-01,8.414853e-01,8.675935e-01,8.915057e-01,9.131613e-01,9.325056e-01,9.494896e-01,9.640703e-01,9.762109e-01,9.858804e-01,9.930546e-01,9.977152e-01,9.998504e-01,9.994549e-01,9.965296e-01,9.910819e-01,9.831257e-01,9.726811e-01,9.597744e-01,9.444384e-01,9.267119e-01,9.066398e-01,8.842728e-01,8.596676e-01,8.328864e-01,8.039971e-01,7.730728e-01,7.401917e-01,7.054371e-01,6.688969e-01,6.306636e-01,5.908340e-01,5.495090e-01,5.067930e-01,4.627943e-01,4.176242e-01,3.713970e-01,3.242298e-01,2.762419e-01,2.275548e-01,1.782917e-01,1.285773e-01,7.853747e-02,2.829886e-02,-2.201138e-02,-7.226591e-02,-1.223375e-01,-1.720995e-01,-2.214258e-01,-2.701917e-01,-3.182737e-01,-3.655501e-01,-4.119012e-01,-4.572098e-01,-5.013611e-01,-5.442434e-01,-5.857481e-01,-6.257702e-01,-6.642084e-01,-7.009653e-01,-7.359481e-01,-7.690680e-01,-8.002413e-01,-8.293891e-01,-8.564376e-01,-8.813183e-01,-9.039683e-01,-9.243302e-01,-9.423525e-01,-9.579895e-01,-9.712018e-01,-9.819557e-01,-9.902243e-01,-9.959864e-01,-9.992275e-01,-9.999394e-01,-9.981204e-01,-9.937749e-01,-9.869141e-01,-9.775552e-01,-9.657220e-01,-9.514445e-01,-9.347587e-01,-9.157068e-01,-8.943372e-01,-8.707039e-01,-8.448667e-01,-8.168910e-01,-7.868477e-01,-7.548127e-01,-7.208672e-01,-6.850971e-01,-6.475929e-01,-6.084495e-01,-5.677661e-01,-5.256456e-01,-4.821945e-01,-4.375230e-01,-3.917441e-01,-3.449735e-01,-2.973298e-01,-2.489336e-01,-1.999072e-01,-1.503748e-01,-1.004618e-01,-5.029457e-02,-1.959435e-15};

    @Test
    @Order(1)
    public void createTestOutputDirectory() {
        String dirName = "./test_outputs/";
        File directory = new File(dirName);
        if (! directory.exists()){
            directory.mkdir();
        }
    }

    @Test
    public void NLMSTest1() throws IOException {
        double mu = 0.1;
        int length = 4;
        String outputFileName = "test_outputs/NLMSTest1.png";
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,-1.913567e-02,9.644233e-03,-5.822620e-03,2.319570e-01,-2.280032e+00,1.633909e+00,3.106163e-01,-0.381716e-01,1.43221,2.007994e+00,2.053545e+00,7.891387e-01,1.214766e-01,1.232024e+00,4.289248e-01,3.282060e+00,-1.959389e+00,5.446617e-01,-2.549571e-01,-2.564267e+00,-9.248252e-01,-3.081653e-01,-5.703988e-01,-1.293991e-01,4.973694e+00,-3.434379e-01,-1.380283e+00,4.498115e-01,-2.194023e-01,-7.609056e-02,6.926962e-01,3.025173e+00,1.225115e+00,-4.390540e-01,-1.967939e+00,6.067990e+00,-9.431182e-01,-1.080323e+00,4.858657e+00,-3.158694e+00,5.342106e-01,-6.174560e-01,4.278949e+00,1.434761e-01,5.881890e-01,4.307201e+00,2.995618e+00,-1.602819e+00,-4.700116e+00,-3.781894e+00,4.398818e-01,-2.486521e+00,3.825456e+00,-7.287003e+00,1.891789e-01,-3.076702e+00,3.401460e+00,3.117728e+00,1.271828e+00,-7.575880e-01,-3.955281e+00,-3.549420e+00,-1.950680e+00,4.185545e+00,6.633856e-02,-4.862587e+00,-3.171229e+00,5.363190e+00,8.934604e+00,3.284326e+00,4.810142e+00,3.277955e+00,5.086578e+00,1.855980e+00,-1.987295e+00,5.083860e+00,2.264808e+00,-5.762123e-01,3.295967e-02,-2.707252e+00,-5.881406e-01,-4.375442e+00,1.099283e+01,3.111975e-01,4.102009e+00,5.321727e-01,3.251275e+00,4.602224e+00,-1.201118e+00,-1.968421e+00,4.166239e-01,-2.088819e+00,1.546082e+00,2.200682e+00,4.852358e+00,3.016739e+00,9.841390e-01,-4.947384e-02,-3.364673e+00,-3.989378e+00,-6.419692e+00,5.191085e+00,-6.711466e+00,-4.232108e+00,9.578049e+00,-4.960075e+00,6.734879e-02,5.446707e+00,-1.360601e+00,-4.165223e-01,-5.524697e-01,2.883988e+00,6.089522e-01,-1.857194e+00,6.898488e-01,2.575902e+00,3.126794e+00,-6.801286e+00,-1.721459e+00,4.907785e+00,-4.157327e+00,3.712707e+00,-8.207942e+00,2.558770e+00,-3.621127e+00,4.847700e+00,-4.977816e+00,-1.348466e-01,8.086652e-01,5.607636e+00,-2.570728e+00,4.396520e+00,7.122537e+00,2.163478e-01,2.006025e+00,-6.276080e+00,1.666212e+00,5.101418e+00,2.710431e-01,2.308859e+00,-2.506426e+00,-2.600398e+00,-2.347812e+00,-6.222939e-01,9.489980e-01,-7.475396e-02,-2.991575e+00,-1.741864e+00,2.598526e+00,8.077144e-01,-3.187911e+00,6.412615e+00,1.991896e+00,-5.293677e+00,2.059473e+00,-7.621946e-01,2.516871e+00,2.879037e+00,-4.309212e+00,-4.592112e+00,-6.548691e+00,-3.375588e+00,-5.486407e-02,7.040420e-01,-3.713512e+00,-3.337896e-01,-2.710776e+00,-4.650604e+00,-7.243545e+00,-3.685247e+00,-1.083280e+01,-7.462294e-01,-5.487213e-01,-1.053556e+00,6.782904e-01,-3.063280e+00,5.669990e+00,-6.729556e+00,-5.939009e+00,-1.731180e+00,1.063611e+00,3.275798e+00,-1.211286e+01,9.489911e-01,-9.498630e+00,-1.127273e+00,-7.485883e+00,1.531899e+00,3.069147e-01,-3.725011e+00,1.735381e+00,5.634484e+00,-1.268195e+00,6.329459e+00,-9.959390e-02,-9.334362e-01,3.078773e-01,1.315052e+00,1.300378e+00,2.915159e+00,-8.123357e-02,-9.150178e-01,9.607442e-01,2.223099e+00,3.007240e+00,-1.495354e+00,1.901438e+00,2.856264e-01,-3.430402e+00,-2.359353e+00,-2.498281e+00,8.188639e+00,3.054233e+00,-1.162524e+00,2.288467e+00,9.600575e-01,-7.252222e+00,-3.887651e+00,-1.609879e+00,2.179292e+00,-5.585192e+00,3.250345e+00,8.524404e+00,-1.241254e+01,-4.376539e+00,1.767440e-02,4.589020e+00,7.213344e+00,-1.629210e+00,-7.649721e+00,1.329654e+00,-5.587428e+00,1.284069e+00,1.057744e+00,3.094442e-01,-5.058597e-01,4.902311e+00,7.567940e-01,-8.349228e+00,-1.378034e+00,-2.834166e-01,4.568659e+00,-7.612779e+00,-5.016349e-01,2.667397e+00,1.747587e-01,1.066581e+00,-2.525015e+00,4.017282e+00,2.934726e+00,-2.572435e+00,4.740898e+00,3.180701e+00,-5.006363e-01,3.211000e+00,6.973813e+00,5.261521e+00,-2.969950e+00,-4.730804e-01,1.490356e+00,8.656975e-01,2.404566e+00,-1.271306e+01,-1.678111e+00,-5.798974e-01,-5.239147e-02,3.994294e+00,-1.466720e-01,4.661478e+00,-3.669853e+00,2.824240e+00,4.752034e+00,-1.193278e+01,3.802017e-01,-8.816550e+00,-2.004147e+00,3.464639e+00,-7.932540e+00,-5.665270e+00,5.341964e+00,-1.856444e+00,3.767704e+00,2.094159e+00,-5.083992e+00,-9.680362e+00,2.117960e+00,1.810203e+00,1.871194e-01,-7.184265e+00,-4.159040e+00,-4.595828e+00,-8.480278e-01,-5.749642e+00,3.832951e+00,4.836513e+00,-4.278215e+00,3.510041e+00,-5.417238e+00,8.298303e+00,-7.970822e+00,-6.308041e+00,7.158563e-01,2.359358e+00,6.075790e+00,-6.826005e+00,-1.658422e+00,-5.372487e+00,3.625738e+00,3.606656e+00,2.667595e+00,-2.215293e+00,2.475873e+00,2.866556e+00,-3.305838e+00,2.512457e+00,8.482106e+00,6.487004e+00,1.688619e+00,3.729077e+00,-3.870335e+00,-3.987285e+00,-2.078456e+00,-6.474361e+00,-1.147600e+00,-4.274170e+00,-6.383891e-01,-1.700862e+00,2.922130e+00,-2.041512e+00,8.178325e-01,-6.882375e+00,-1.142741e+00,2.257451e+00,1.763709e+00,-3.812452e+00,-1.306668e+00,6.705246e+00,-5.158904e+00,6.119947e+00,4.126785e+00,-5.188898e-01,-1.977939e+00,3.344185e+00,-1.640737e+00,-6.993246e-01,2.182592e+00,-2.854662e+00,9.558266e-02,-3.236054e+00,5.609055e+00,-4.769000e+00,4.675493e+00,1.193283e-01,1.383967e+01,-5.880477e+00,-4.875417e-01,-6.278530e+00,-2.582043e-01,4.683166e-01,-2.972767e+00,1.358997e+01,3.167390e+00,3.929613e-01,2.852290e+00,5.885309e+00,2.574903e-01,-3.700218e+00,4.965009e-01,-3.238018e+00,5.940344e+00,-3.576156e+00,8.960790e+00,8.134748e+00,3.719045e+00,-1.665676e+00,-2.044653e+00,6.034864e+00,-6.245169e+00,4.741851e-02,4.183515e+00,1.379852e+00,3.450979e+00,-1.870875e+00,-1.035517e+01,-2.577533e+00,-9.765830e-02,-1.886556e+00,1.268050e+00,2.541175e+00,8.135890e+00,-5.702124e-02,5.692679e+00,-1.043058e+01,4.101508e+00,-1.995104e+00,8.145439e-01,6.349198e+00,-2.402096e+00,3.544194e+00,4.462910e+00,-8.132853e+00,-3.501196e+00,-1.261060e+00,-3.156412e+00,2.400902e+00,9.837739e-01,-3.220589e+00,2.156805e+00,-2.874818e-02,3.487826e-01,6.999742e+00,-3.531703e+00,-4.371512e-01,-3.210408e+00,6.322297e+00,-2.479741e-01,4.343348e+00,-4.437142e+00,-1.038985e+01,9.951091e-01,7.871011e-01,9.436210e+00,4.254338e+00,-1.138277e+00,-6.890702e+00,-2.230654e+00,-6.254442e+00,6.573852e-01,-9.758683e-01,-8.544015e+00,-3.837289e+00,5.501106e+00,5.515486e+00,-1.245664e+00,-6.201493e+00,8.608138e+00,4.326692e+00,-1.667451e+00,-6.265838e+00,7.579562e+00,-3.168849e+00,-2.829891e+00,1.333976e-01,5.752741e+00,6.717443e+00,9.168200e+00,1.597561e+00,7.658661e-01,2.094074e+00,-3.385709e+00,5.650523e+00,5.255718e+00,4.194054e+00,9.984224e+00,-4.993034e+00,-2.045212e+00,2.974039e+00,3.263424e-01,1.002583e+00,4.887874e+00,-2.297469e+00,5.264921e-02,5.828471e-01,4.935913e+00,4.567069e-01,-1.016908e+00,-3.195980e+00,-3.064826e+00,-3.623793e+00,-1.677771e-01,5.637015e+00,7.066110e+00,-1.388036e+00,2.488617e+00,-1.201026e-01,-2.799898e-01,-7.064959e+00,-5.723753e+00,1.079842e+00,3.259559e+00,1.494706e+00,-5.686538e-01,-2.865404e+00,-4.867026e+00,-1.369869e-01,1.209280e+00,1.558010e+00,-1.769743e+00,-1.995966e+00,-7.500511e-02,2.526998e+00,-5.361134e+00,1.378730e+00,4.239913e+00,-1.321548e+00,-3.028404e+00,-8.258905e+00,1.842130e+00,6.693688e+00};

        NLMS filt1 = new NLMS(mu, length, NLMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired1, this.signal1);

        NLMS filt2 = new NLMS(mu, weights);
        filt2.filter(this.desired1, this.signal1);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.1);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.1);

        // Save plot result
        Plotting fig = new Plotting(600, 300, "NLMS Application", "Time", "Signal");
        fig.initialisePlot();
        fig.addSignal("Desired", this.desired1, false);
        fig.addSignal("Output", filt1.getOutput(), false);
        fig.addSignal("Error", filt1.getError(), false);
        fig.saveAsPNG(outputFileName);
    }

    @Test
    public void NLMSTest2() throws IOException {
        double mu = 1;
        int length = 20;
        String outputFileName = "test_outputs/NLMSTest2.png";
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,0,-1.464684e-02,-3.050340e-02,1.009006e-01,2.026721e-01,3.003929e-01,3.969671e-01,6.112817e-01,5.681300e-01,4.699671e-01,5.033567e-01,4.809130e-01,5.933191e-01,6.075221e-01,6.351595e-01,6.905352e-01,8.033503e-01,8.276656e-01,8.673143e-01,8.570127e-01,8.023211e-01,8.633987e-01,9.248569e-01,9.637966e-01,9.827972e-01,9.624284e-01,9.467327e-01,9.735977e-01,9.524028e-01,1.009172e+00,9.716751e-01,9.917334e-01,9.589005e-01,9.347995e-01,1.035212e+00,1.012071e+00,1.017354e+00,9.849985e-01,8.865540e-01,8.990965e-01,8.588833e-01,8.794055e-01,8.440648e-01,8.099807e-01,7.579768e-01,7.292700e-01,7.318557e-01,7.005843e-01,6.729715e-01,5.680565e-01,5.290374e-01,4.358606e-01,4.269830e-01,4.026828e-01,4.253858e-01,3.404978e-01,3.118064e-01,2.004642e-01,2.010205e-01,1.019231e-01,8.076927e-02,8.943492e-03,1.912048e-02,-2.131381e-02,-1.053808e-01,-2.193688e-01,-2.805912e-01,-3.246482e-01,-2.661311e-01,-3.374654e-01,-3.469923e-01,-4.708570e-01,-4.789979e-01,-5.684074e-01,-6.147989e-01,-6.902257e-01,-6.592337e-01,-6.667857e-01,-6.875661e-01,-7.049422e-01,-7.757338e-01,-7.970520e-01,-8.367363e-01,-9.095045e-01,-9.132971e-01,-9.288962e-01,-9.645081e-01,-9.593527e-01,-1.004585e+00,-1.024342e+00,-9.933125e-01,-9.585740e-01,-9.000228e-01,-9.756844e-01,-9.965896e-01,-1.046049e+00,-1.052095e+00,-1.011315e+00,-1.021284e+00,-9.099159e-01,-9.220003e-01,-8.560339e-01,-8.854484e-01,-8.333195e-01,-8.473113e-01,-7.845335e-01,-7.701786e-01,-6.917745e-01,-7.072162e-01,-7.405269e-01,-7.058027e-01,-6.025181e-01,-5.416441e-01,-4.696715e-01,-4.609140e-01,-3.848706e-01,-4.157596e-01,-3.555704e-01,-3.639391e-01,-1.693411e-01,-1.398827e-01,-6.372772e-02,-1.149869e-01,-8.269806e-02,-3.428019e-02,6.618312e-02,1.214643e-01,1.824173e-01,1.770671e-01,2.168433e-01,2.811375e-01,3.174772e-01,4.194565e-01,4.654725e-01,5.382752e-01,5.323777e-01,6.017736e-01,6.160955e-01,6.658676e-01,6.799298e-01,7.014578e-01,7.186356e-01,7.794764e-01,7.997706e-01,8.440737e-01,8.744085e-01,8.976070e-01,9.014594e-01,9.792899e-01,9.963967e-01,1.013336e+00,9.905045e-01,9.636824e-01,1.003396e+00,1.002226e+00,9.883768e-01,1.013236e+00,9.986621e-01,9.839814e-01,9.669910e-01,9.362656e-01,9.182184e-01,9.949046e-01,9.812303e-01,9.561725e-01,8.500140e-01,7.847664e-01,7.643933e-01,8.069000e-01,7.497820e-01,6.827738e-01,6.461022e-01,6.590590e-01,6.768550e-01,6.446849e-01,5.577612e-01,5.035992e-01,4.377505e-01,4.145172e-01,3.300165e-01,3.122146e-01,2.255852e-01,2.135534e-01,1.830232e-01,1.611905e-01,6.475812e-02,3.625002e-02,-3.478883e-02,-7.640946e-02,-1.404756e-01,-2.197841e-01,-2.634662e-01,-2.900750e-01,-3.273800e-01,-3.594520e-01,-3.741371e-01,-4.388935e-01,-5.188425e-01,-5.674414e-01,-6.260209e-01,-6.664343e-01,-6.756713e-01,-7.133605e-01,-7.202247e-01,-7.507683e-01,-8.093898e-01,-8.576479e-01,-8.774264e-01,-9.082206e-01,-9.196294e-01,-8.854464e-01,-9.416393e-01,-9.539930e-01,-1.005153e+00,-1.013648e+00,-9.969378e-01,-9.872919e-01,-9.504808e-01,-9.648023e-01,-9.873498e-01,-9.810762e-01,-9.516815e-01,-9.585073e-01,-1.000226e+00,-1.002107e+00,-9.611049e-01,-8.904119e-01,-8.707828e-01,-8.401696e-01,-8.241723e-01,-8.117148e-01,-8.092040e-01,-7.876918e-01,-7.285293e-01,-6.753520e-01,-6.168369e-01,-6.412941e-01,-5.584384e-01,-4.928999e-01,-4.515198e-01,-3.680923e-01,-3.544106e-01,-3.145244e-01,-2.778006e-01,-2.678590e-01,-2.176933e-01,-1.165724e-01,-5.908011e-02,-5.742621e-03,5.015560e-03,4.663056e-02,1.105865e-01,1.770275e-01,2.109730e-01,2.581605e-01,3.518022e-01,3.383249e-01,4.454946e-01,4.608120e-01,5.331870e-01,5.120001e-01,5.428226e-01,5.731997e-01,6.752587e-01,6.952617e-01,7.420430e-01,7.607246e-01,8.100363e-01,8.686892e-01,8.779656e-01,9.206834e-01,9.276194e-01,9.197045e-01,9.225568e-01,9.115531e-01,9.262769e-01,9.708645e-01,1.005114e+00,1.025677e+00,1.036049e+00,1.024162e+00,1.015339e+00,1.011064e+00,1.000918e+00,9.729713e-01,9.438265e-01,9.105225e-01,9.261600e-01,9.011180e-01,8.982200e-01,8.343253e-01,8.577838e-01,8.588137e-01,8.390769e-01,7.801659e-01,6.779533e-01,6.663263e-01,6.109206e-01,5.780020e-01,5.558283e-01,5.419340e-01,5.362510e-01,5.125317e-01,4.573956e-01,3.719366e-01,3.149544e-01,2.392571e-01,2.233174e-01,1.704077e-01,1.382144e-01,6.084495e-02,5.630310e-03,-3.192565e-02,-1.262579e-01,-1.687702e-01,-2.419321e-01,-2.561134e-01,-2.646183e-01,-2.843457e-01,-3.557995e-01,-4.298592e-01,-4.822928e-01,-5.247039e-01,-5.454082e-01,-5.894432e-01,-6.418258e-01,-6.844834e-01,-7.472443e-01,-7.489838e-01,-7.727868e-01,-8.039127e-01,-8.423198e-01,-8.807743e-01,-8.892333e-01,-9.012026e-01,-8.799854e-01,-8.901755e-01,-9.614449e-01,-9.991126e-01,-1.042938e+00,-1.020218e+00,-9.917929e-01,-9.726552e-01,-9.774707e-01,-9.455359e-01,-9.808791e-01,-9.809215e-01,-9.849019e-01,-9.704188e-01,-9.405357e-01,-9.290523e-01,-9.199446e-01,-9.394477e-01,-8.668881e-01,-8.393882e-01,-7.823969e-01,-7.579908e-01,-7.402406e-01,-7.159704e-01,-6.914335e-01,-6.567817e-01,-5.811894e-01,-5.340177e-01,-4.914639e-01,-4.549523e-01,-4.222135e-01,-3.925954e-01,-3.572671e-01,-3.023375e-01,-2.509584e-01,-1.817777e-01,-1.409803e-01,-8.041902e-02,-9.527726e-03,2.326260e-02,6.176225e-02,1.204125e-01,1.472628e-01,2.164228e-01,3.094312e-01,3.755373e-01,4.017731e-01,4.024140e-01,4.084592e-01,4.867729e-01,5.569053e-01,6.088867e-01,6.169676e-01,6.478679e-01,6.731206e-01,7.130883e-01,7.494650e-01,7.753021e-01,8.149064e-01,8.592381e-01,8.785931e-01,9.221165e-01,9.493284e-01,9.831738e-01,9.964210e-01,9.958571e-01,9.664767e-01,9.541671e-01,9.585899e-01,9.927935e-01,1.037092e+00,1.036374e+00,1.037535e+00,1.012233e+00,1.004912e+00,9.669879e-01,9.262354e-01,8.789210e-01,8.753901e-01,8.962476e-01,8.904618e-01,8.642427e-01,8.156298e-01,7.750435e-01,7.401326e-01,7.170723e-01,6.886882e-01,6.654450e-01,6.394785e-01,5.940308e-01,5.682033e-01,5.115298e-01,4.756436e-01,3.930142e-01,3.375380e-01,2.742914e-01,2.378928e-01,2.048860e-01,1.320164e-01,6.579426e-02,-7.263374e-04,-1.041441e-02,-1.196462e-02,-4.641843e-02,-1.042689e-01,-1.656947e-01,-2.460830e-01,-3.050740e-01,-3.682965e-01,-3.888843e-01,-4.094408e-01,-4.319043e-01,-4.860956e-01,-5.526914e-01,-6.103449e-01,-6.924884e-01,-7.353731e-01,-7.375963e-01,-7.438390e-01,-7.670775e-01,-8.020245e-01,-8.316613e-01,-8.487295e-01,-8.663955e-01,-9.006627e-01,-8.972899e-01,-9.454631e-01,-9.510715e-01,-1.011151e+00,-1.009738e+00,-1.015778e+00,-9.825025e-01,-9.618150e-01,-9.523096e-01,-9.644166e-01,-9.828073e-01,-9.683261e-01,-9.665646e-01,-9.536391e-01,-9.545100e-01,-9.487398e-01,-9.086774e-01,-9.007276e-01,-8.660309e-01,-8.403631e-01,-7.956307e-01,-7.710204e-01,-7.202964e-01,-6.784244e-01,-6.494246e-01,-6.182833e-01,-5.968949e-01,-5.525933e-01,-5.050590e-01,-4.671168e-01,-4.145648e-01,-3.578243e-01,-3.043296e-01,-2.342678e-01,-2.069498e-01,-1.890837e-01,-1.711874e-01,-1.054890e-01,-2.068774e-02,5.349355e-02,1.119168e-01,1.507163e-01,1.973047e-01,2.380954e-01,2.790983e-01,3.172046e-01,4.100770e-01,4.380879e-01,4.505282e-01,4.564999e-01,4.949939e-01,5.744880e-01,6.447323e-01,7.076177e-01,7.520261e-01,7.943515e-01,8.161258e-01,8.437794e-01,8.582108e-01,8.521532e-01,8.271387e-01,8.490405e-01,8.848551e-01,9.387228e-01,9.736833e-01,1.021284e+00,1.044160e+00,1.027504e+00,9.924164e-01,9.755787e-01,9.824471e-01,9.801136e-01,9.679819e-01,9.695968e-01,9.748644e-01,9.597449e-01,9.627868e-01,9.520147e-01,9.393971e-01,9.164480e-01,8.776208e-01,8.629182e-01,8.200112e-01,7.915453e-01,7.591089e-01,7.279873e-01,6.739925e-01,6.140943e-01,5.740501e-01,5.483552e-01,5.194273e-01,4.951696e-01,4.583928e-01,4.235507e-01,3.636172e-01,3.048594e-01,2.454295e-01,1.892501e-01,1.462516e-01,1.037386e-01,4.768701e-02,1.419485e-02,-2.264970e-02,-7.460718e-02,-1.356748e-01,-2.132383e-01,-2.586728e-01,-2.890596e-01,-3.421419e-01,-3.928626e-01,-4.268616e-01,-4.487334e-01,-4.854054e-01,-5.364625e-01,-6.285598e-01,-6.997013e-01,-7.449014e-01,-7.370123e-01,-7.207425e-01,-7.358258e-01,-7.800569e-01,-8.099525e-01,-8.717551e-01,-9.193518e-01,-9.472980e-01,-9.426050e-01,-9.266012e-01,-9.291032e-01,-9.617204e-01,-9.699807e-01,-9.792737e-01,-9.854583e-01,-9.706272e-01,-9.701598e-01,-9.643458e-01,-9.736478e-01,-9.609093e-01,-9.524552e-01,-9.386683e-01,-9.272081e-01,-9.067775e-01,-8.928144e-01,-8.929571e-01,-8.535957e-01,-8.407787e-01,-8.063322e-01,-7.728725e-01,-7.426145e-01,-6.799167e-01,-6.375903e-01,-6.082949e-01,-5.899550e-01,-5.587702e-01,-5.371217e-01,-4.769524e-01,-4.155304e-01,-3.456193e-01,-2.810931e-01,-2.082495e-01,-1.634635e-01,-1.326916e-01,-1.075958e-01,-7.866530e-02,-4.585720e-02,-6.490557e-03,7.078067e-02,1.408038e-01,2.136540e-01,2.531899e-01,2.914978e-01,3.397562e-01,3.717994e-01,4.271035e-01,4.618868e-01,5.126427e-01,5.668339e-01,5.885838e-01,6.089128e-01,6.493585e-01,6.983148e-01,7.520529e-01,7.905303e-01,8.440931e-01,8.600871e-01,8.972328e-01,9.346641e-01,9.498420e-01,9.597942e-01,9.580876e-01,9.484127e-01,9.547562e-01,9.794860e-01,1.023729e+00,1.033970e+00,1.003798e+00,9.844318e-01,9.738874e-01,9.808847e-01,9.712487e-01,9.747666e-01,9.541543e-01,9.403604e-01,9.104584e-01,8.844124e-01,8.798929e-01,8.819068e-01,8.600346e-01,8.351292e-01,8.126123e-01,7.743614e-01,7.288333e-01,6.831540e-01,6.505626e-01,6.247192e-01,5.937462e-01,5.548032e-01,4.823376e-01,4.023043e-01,3.270822e-01,2.855564e-01,2.386232e-01,2.199935e-01,1.909841e-01,1.458550e-01,9.404637e-02,3.763544e-02,-1.050759e-02,-6.240963e-02,-1.121085e-01,-1.578637e-01,-1.913471e-01,-2.302605e-01,-2.899280e-01,-3.595164e-01,-4.330714e-01,-4.763484e-01,-5.059615e-01,-5.243512e-01,-5.623044e-01,-5.878939e-01,-6.273465e-01,-6.591757e-01,-7.234108e-01,-7.814543e-01,-8.176464e-01,-8.365592e-01,-8.622430e-01,-9.099925e-01,-9.376486e-01,-9.603841e-01,-9.512281e-01,-9.503958e-01,-9.486049e-01,-9.693385e-01,-9.767651e-01,-9.704279e-01,-9.753758e-01,-9.745483e-01,-9.938238e-01,-9.921366e-01,-9.902051e-01,-9.721736e-01,-9.729530e-01,-9.612822e-01,-9.489724e-01,-9.347267e-01,-9.255540e-01,-8.930777e-01,-8.562757e-01,-8.226057e-01,-7.945951e-01,-7.737230e-01,-7.596134e-01,-7.366309e-01,-6.947201e-01,-6.388726e-01,-5.733432e-01,-5.065951e-01,-4.454368e-01,-3.930759e-01,-3.629352e-01,-3.606702e-01,-3.413609e-01,-3.015082e-01,-2.406339e-01,-1.659311e-01,-8.873567e-02,-2.482876e-02,-5.785654e-03,3.629458e-02,9.694077e-02,1.686322e-01,1.965290e-01,2.322972e-01,2.719655e-01,3.188807e-01,3.704050e-01,4.059889e-01,4.413928e-01,4.810957e-01,5.485726e-01,6.073708e-01,6.679085e-01,7.039701e-01,7.393929e-01,7.612042e-01,7.769206e-01,7.871081e-01,8.072691e-01,8.394428e-01,8.686343e-01,8.942261e-01,9.302967e-01,9.530080e-01,9.449191e-01,9.554789e-01,9.786878e-01,1.004308e+00,1.022318e+00,1.042454e+00,1.023561e+00,9.899560e-01,9.553720e-01,9.492825e-01,9.783279e-01,9.968760e-01,9.878316e-01,9.490173e-01,8.984290e-01,8.469066e-01,8.245737e-01,7.983193e-01,7.929232e-01,7.921500e-01,7.770040e-01,7.521871e-01,6.852679e-01,6.308126e-01,5.893535e-01,5.641972e-01,5.104429e-01,4.468738e-01,3.873715e-01,3.611934e-01,3.350482e-01,2.927391e-01,2.382651e-01,1.838379e-01,1.191260e-01,6.883563e-02,1.530147e-02,-3.759718e-02,-8.359813e-02,-1.231456e-01,-1.593013e-01,-2.030254e-01,-2.656259e-01,-3.168791e-01,-3.674284e-01,-4.186915e-01,-4.710618e-01,-5.097695e-01,-5.567438e-01,-6.018457e-01,-6.383040e-01,-6.685642e-01,-6.971123e-01,-7.200785e-01,-7.506225e-01,-7.795891e-01,-8.049571e-01,-8.440955e-01,-8.797558e-01,-9.084814e-01,-9.309558e-01,-9.588474e-01,-9.744598e-01,-9.863411e-01,-1.005089e+00,-1.012430e+00,-1.003639e+00,-9.883554e-01,-9.858724e-01,-1.000122e+00,-1.026833e+00,-1.033970e+00,-1.007991e+00,-9.679244e-01,-9.370735e-01,-9.155982e-01,-9.115947e-01,-8.982863e-01,-8.598183e-01,-8.388420e-01,-8.369608e-01,-8.303016e-01,-7.915160e-01,-7.270287e-01,-6.628486e-01,-6.279236e-01,-6.083094e-01,-5.787608e-01,-5.531381e-01,-5.202991e-01,-4.760659e-01,-4.204838e-01,-3.614506e-01,-3.041730e-01,-2.499482e-01,-2.017696e-01,-1.556450e-01,-1.039483e-01,-4.528145e-02,1.114066e-02,4.671488e-02,6.799269e-02,9.183305e-02,1.467599e-01,2.390449e-01,3.178145e-01,3.646566e-01,3.808189e-01,4.014032e-01,4.481198e-01,4.919899e-01,5.296894e-01,5.668230e-01,6.075700e-01,6.622092e-01,7.031172e-01,7.711380e-01,8.138998e-01,8.413223e-01,8.387783e-01,8.307712e-01,8.371635e-01,8.671510e-01,9.422215e-01,9.661516e-01,9.925120e-01,9.827677e-01,9.833883e-01,9.979668e-01,1.005936e+00,9.762898e-01,9.702779e-01,9.699125e-01,9.580696e-01,9.706971e-01,9.636590e-01,9.846213e-01,9.605170e-01,9.480837e-01,8.844597e-01,8.444904e-01,8.026312e-01,7.968497e-01,8.005349e-01,8.008438e-01,8.079036e-01,7.656939e-01,7.049656e-01,6.452302e-01,5.789841e-01,5.286895e-01,4.943558e-01,4.431637e-01,4.040874e-01,3.515772e-01,3.048863e-01,2.556779e-01,2.122872e-01,1.647987e-01,1.027013e-01,6.015542e-02,2.676285e-02,-1.375710e-02,-5.235819e-02,-1.179040e-01,-1.648261e-01,-2.278856e-01,-2.717471e-01,-3.331742e-01,-3.809621e-01,-4.233155e-01,-4.738320e-01,-5.284469e-01,-5.723137e-01,-6.084926e-01,-6.400212e-01,-6.704634e-01,-7.093037e-01,-7.503688e-01,-7.769461e-01,-7.867170e-01,-8.057686e-01,-8.334330e-01,-8.532240e-01,-8.833103e-01,-9.200246e-01,-9.719369e-01,-9.986564e-01,-1.010844e+00,-1.008304e+00,-1.004936e+00,-9.969730e-01,-9.811610e-01,-9.775412e-01,-9.890582e-01,-1.005461e+00,-1.008121e+00,-1.002415e+00,-9.777434e-01,-9.477130e-01,-9.154007e-01,-9.039231e-01,-8.860051e-01,-8.558321e-01,-8.254632e-01,-8.123992e-01,-8.018300e-01,-7.709917e-01,-7.352341e-01,-6.880419e-01,-6.391829e-01,-5.965123e-01,-5.660961e-01,-5.483255e-01,-5.337457e-01,-5.011606e-01,-4.400708e-01,-3.744731e-01,-2.937632e-01,-2.171839e-01,-1.514674e-01,-1.014354e-01,-7.087117e-02,-4.418094e-02,-1.841503e-02};

        NLMS filt1 = new NLMS(mu, length, NLMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired2, this.signal2);
        NLMS filt2 = new NLMS(mu, weights);
        filt2.filter(this.desired2, this.signal2);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.1);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.1);

        // Save plot result
        Plotting fig = new Plotting(600, 300, "NLMS Application", "Time", "Signal");
        fig.initialisePlot();
        fig.addSignal("Desired", this.desired2, false);
        fig.addSignal("Output", filt1.getOutput(), false);
        fig.addSignal("Error", filt1.getError(), false);
        fig.saveAsPNG(outputFileName);
    }

    @Test
    public void NLMSTestLeakage1() {
        double mu = 0.1;
        double leakageFactor = 0.5;
        int length = 4;
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,-1.913567e-02,1.022218e-02,-1.137443e-03,2.542639e-02,-9.948345e-01,7.389825e-01,1.699340e-02,-1.321490e-01,7.937873e-02,3.598450e-01,5.324111e-01,4.678224e-01,1.088035e-01,1.773674e-02,4.535276e-02,1.840027e-01,-2.454566e-01,1.822090e-01,-7.385695e-02,-5.586294e-02,-1.067504e-01,-6.275321e-02,-5.683662e-02,-2.466468e-02,5.512833e-02,-8.032591e-02,-1.752765e-01,4.971572e-02,4.008621e-02,-3.653083e-03,6.258714e-03,4.920178e-01,3.283371e-01,3.459533e-03,-1.899414e-01,3.359855e-01,-2.959727e-01,-9.097851e-02,2.558422e-01,-3.369401e-01,2.261741e-01,8.896216e-03,1.439373e-01,-1.622706e-01,8.494640e-02,2.069953e-02,2.444546e-01,1.100546e-01,-3.232194e-01,-4.445506e-01,-3.175394e-02,1.186949e-01,6.131260e-02,-7.204476e-01,6.604158e-01,-3.313428e-01,3.578526e-01,-1.431536e-02,1.513511e-01,-7.248535e-02,-1.588621e-01,-3.865145e-01,-3.001912e-01,1.092078e-01,2.347895e-01,-1.636259e-01,-1.850649e-01,3.645495e-01,8.558049e-01,3.910392e-01,1.223033e-01,4.397478e-01,4.412047e-01,6.284872e-01,2.497224e-01,8.767625e-02,1.100415e-01,-8.535570e-02,7.734072e-02,-4.942944e-03,-6.473315e-03,-1.997609e-01,9.974781e-01,-3.320845e-01,4.131614e-01,-1.757793e-01,1.258358e-01,3.106064e-01,2.097460e-01,-2.469257e-02,2.921539e-03,-1.444537e-02,6.298797e-02,-6.717772e-03,3.137285e-01,4.379163e-01,2.964099e-01,8.141737e-02,-5.732437e-02,-3.238402e-01,-7.361144e-01,1.014124e-01,-4.201587e-01,9.037847e-03,6.298845e-01,-6.943942e-01,-6.142984e-02,3.339498e-01,-3.185730e-01,-3.876262e-02,1.017018e-01,2.046490e-02,2.552442e-02,-9.451211e-02,1.441383e-02,1.225797e-01,1.804038e-01,-5.020494e-01,-2.751614e-01,4.034417e-01,-2.575197e-01,1.302717e-01,-5.953886e-01,8.223626e-01,-5.329040e-01,5.327183e-01,-5.302252e-01,5.559399e-01,-1.223804e-01,6.268704e-02,-1.372177e-01,2.445706e-01,1.146177e-01,1.281281e-02,1.661075e-01,-1.809060e-03,1.694521e-01,1.650381e-02,-9.198117e-02,-3.575529e-02,-2.719993e-03,-2.880366e-02,-1.749715e-01,-7.071694e-02,-1.644160e-02,5.792381e-02,-2.910152e-02,-1.505556e-01,1.480172e-01,1.342153e-01,-1.642484e-01,4.571487e-01,4.627067e-02,-4.887560e-01,2.606684e-01,1.047208e-01,1.871002e-02,-2.612524e-02,-1.694578e-01,-3.481651e-01,-4.853539e-01,-4.953975e-01,-2.682663e-01,1.170772e-02,-1.209380e-02,2.660119e-03,-6.455184e-02,-2.746753e-01,-7.571002e-01,-9.405597e-01,-1.096660e+00,-8.948513e-01,-3.456310e-01,-1.209427e-01,-9.448242e-03,-9.231752e-02,6.522497e-01,-1.116554e+00,1.932360e-02,2.508516e-03,2.839237e-02,1.439736e-01,-2.897892e-01,2.895692e-01,-4.540895e-01,2.299403e-01,-4.206236e-01,1.182930e-02,-1.863560e-01,7.293149e-03,1.063825e-01,1.107413e-01,-2.328938e-01,1.727417e-01,-1.680597e-02,5.503606e-02,6.668825e-02,1.562600e-02,8.540905e-02,2.393912e-01,1.587383e-01,-3.418047e-02,-1.526546e-02,5.811627e-02,2.896159e-01,3.972027e-03,2.135162e-02,3.014797e-03,-8.965483e-02,-1.033262e-01,-1.796474e-01,3.197093e-01,3.859895e-01,-3.879795e-02,-5.880276e-02,7.585331e-02,-1.582178e-01,-3.045468e-01,-8.885643e-02,2.287253e-02,-2.063811e-02,3.234113e-01,2.309955e-01,-1.264487e+00,-1.113155e-01,4.262146e-01,1.278918e-01,2.945571e-01,1.076982e-01,-4.970295e-01,-1.713879e-01,2.398302e-02,1.275307e-01,-1.075527e-01,-4.480032e-03,-1.489275e-02,3.142312e-02,2.117345e-02,-4.465427e-01,-1.108812e-01,1.535617e-01,1.428577e-01,-1.961039e-01,2.531254e-01,1.588654e-01,-8.410323e-02,-1.997955e-02,-6.311042e-02,2.631352e-01,-1.080249e-02,-1.950590e-01,2.451990e-01,1.753628e-01,-1.329162e-01,1.561005e-01,3.768090e-01,6.271218e-01,2.669851e-01,-1.130039e-01,4.908005e-02,-3.488510e-02,3.309098e-02,-7.898076e-01,-1.578700e-01,-1.149192e-01,6.095695e-02,6.528209e-02,1.346475e-02,1.841603e-01,-3.438473e-01,4.125310e-01,-9.509037e-02,-8.107285e-01,3.596265e-01,-2.433805e-01,7.084024e-02,-6.203590e-02,-2.388882e-01,-2.438627e-01,3.826542e-01,-1.291551e-01,-8.508934e-02,-1.047241e-01,-1.230527e-01,-5.174034e-01,9.851758e-02,3.374830e-01,3.084546e-02,-1.316892e-01,-4.285295e-01,-3.682488e-01,-2.382904e-01,-2.471864e-01,-5.567822e-02,6.653348e-02,-2.343320e-01,1.530441e-01,-2.166015e-01,8.417266e-01,-1.322983e+00,5.065841e-01,1.464471e-01,7.064949e-02,1.895717e-01,-3.054950e-01,-6.539240e-02,-1.950351e-01,3.586235e-01,1.138465e-01,2.129518e-01,-1.484991e-01,-1.165736e-01,4.863197e-02,-2.286970e-01,2.130896e-01,4.127162e-01,4.335411e-01,4.037718e-01,3.113707e-01,1.544974e-01,-1.323344e-01,-1.867323e-01,-1.777117e-01,-4.241196e-01,-3.299843e-01,-2.831139e-01,-1.609565e-01,-4.015548e-02,-1.179918e-01,2.135177e-01,-2.708734e-01,1.535867e-01,-1.571761e-02,9.871035e-02,-7.575522e-02,-5.521522e-02,3.792385e-01,-4.796596e-01,4.789534e-01,-8.769986e-02,-2.055042e-01,2.641871e-02,1.239675e-02,-1.328475e-01,2.316901e-02,1.306864e-01,-1.923461e-01,8.912874e-02,-6.017454e-02,4.307062e-01,-7.148622e-01,8.515067e-01,-5.510171e-01,5.134864e-01,-7.958771e-01,3.817995e-01,-3.556576e-01,2.296491e-01,-3.138774e-02,2.520602e-02,3.300192e-01,3.736150e-02,-1.250816e-02,1.435811e-01,1.814781e-01,2.362387e-01,-4.482625e-02,-5.756192e-02,-1.897083e-03,3.530345e-01,-5.919900e-01,9.271523e-01,-7.090400e-02,4.511739e-01,1.794588e-01,-1.463015e-01,9.034157e-03,-5.673790e-01,2.851430e-01,2.399140e-01,-1.991328e-01,3.338533e-02,2.242388e-02,-3.165051e-01,-4.069238e-01,4.332085e-02,3.189144e-02,-2.588850e-02,3.468514e-02,5.686891e-01,2.194811e-01,2.426844e-01,-5.174104e-01,6.955134e-01,-5.711744e-01,2.863218e-01,8.672900e-03,-2.427256e-01,1.822084e-01,1.410508e-01,-4.485880e-01,-1.905522e-02,1.526195e-01,-7.971020e-02,-7.655796e-02,1.689805e-02,-6.589506e-02,1.693592e-01,-1.333709e-02,-6.677448e-02,8.418085e-02,-3.358463e-01,9.203791e-02,-2.772151e-02,3.080347e-01,-2.241098e-01,2.521795e-01,-4.554818e-01,-2.470630e-01,-9.599770e-02,2.114163e-01,2.764432e-01,2.194986e-01,1.115450e-01,-3.208041e-01,-3.385043e-01,-1.237176e-01,-1.537985e-01,-1.124000e-01,-1.136539e-01,-3.209770e-01,5.346048e-02,3.712475e-01,-9.001483e-03,-3.244836e-01,2.327346e-01,2.143542e-01,-3.477220e-01,-2.110631e-01,1.662635e-01,-3.430869e-01,-3.071618e-02,2.351241e-01,7.304502e-02,5.462760e-01,9.315587e-01,6.871467e-01,1.784490e-01,8.264535e-02,7.297018e-03,4.431006e-01,1.395129e-01,2.906885e-01,7.640208e-01,2.342225e-01,-1.724249e-02,7.234778e-02,-5.754105e-02,-2.335436e-02,3.153247e-02,-7.167038e-02,7.763387e-02,5.190135e-02,4.329947e-02,6.963780e-02,-5.305064e-02,-1.480051e-01,-1.580634e-01,-3.867277e-01,-2.990389e-01,1.284532e-01,7.106376e-01,1.065830e-01,-1.414411e-01,2.311440e-02,8.698879e-03,-4.334325e-02,-5.593321e-01,-1.738722e-01,2.579038e-01,2.106780e-01,-4.844288e-02,-1.226742e-01,-3.012864e-01,-1.788136e-01,1.301863e-01,1.595923e-01,-2.624386e-02,-1.183402e-01,1.845212e-03,1.394520e-01,-2.376873e-01,2.439686e-01,2.022531e-01,-2.697536e-01,-1.499457e-01,-3.199497e-01,2.652717e-02,4.944880e-01};

        NLMS filt1 = new NLMS(mu, leakageFactor, length, NLMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired1, this.signal1);

        NLMS filt2 = new NLMS(mu, leakageFactor, weights);
        filt2.filter(this.desired1, this.signal1);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.1);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.1);
    }

    @Test
    public void NLMSTestLeakage2() {
        double mu = 1;
        double leakageFactor = 0.9;
        int length = 20;
        double[] weights = new double[length];
        Arrays.fill(weights, 0);

        // Results calculated with MATLAB R2020b Update 4 9.9.0.1570001
        double[] result = {0,0,-1.464684e-02,-3.474959e-02,8.700046e-02,1.751069e-01,2.610124e-01,3.473718e-01,5.323026e-01,4.757044e-01,4.003693e-01,4.848532e-01,4.707319e-01,5.383427e-01,5.701181e-01,5.933129e-01,6.340938e-01,7.160119e-01,7.328510e-01,7.605052e-01,7.747856e-01,7.638036e-01,8.174989e-01,8.518939e-01,8.586416e-01,8.801806e-01,8.871871e-01,8.862779e-01,9.022648e-01,8.994765e-01,9.270204e-01,9.033244e-01,9.125449e-01,9.107214e-01,8.905160e-01,9.205769e-01,8.993828e-01,8.790588e-01,8.776811e-01,8.413198e-01,8.359841e-01,8.191055e-01,7.948781e-01,7.673867e-01,7.400995e-01,7.134967e-01,6.842188e-01,6.596913e-01,6.258026e-01,5.947875e-01,5.463986e-01,5.191001e-01,4.756045e-01,4.365421e-01,4.044300e-01,3.564795e-01,3.124932e-01,2.747998e-01,2.265046e-01,1.908026e-01,1.413710e-01,9.997783e-02,5.683089e-02,1.463586e-02,-2.848038e-02,-7.085077e-02,-1.135429e-01,-1.505357e-01,-1.872748e-01,-2.131405e-01,-2.736323e-01,-2.973704e-01,-3.597310e-01,-3.978962e-01,-4.408737e-01,-4.730816e-01,-5.560383e-01,-5.473623e-01,-6.099227e-01,-6.317453e-01,-6.672257e-01,-7.117843e-01,-7.362936e-01,-7.385477e-01,-8.023923e-01,-8.131332e-01,-8.430535e-01,-8.751713e-01,-8.821710e-01,-8.982103e-01,-9.181613e-01,-9.046084e-01,-9.074084e-01,-8.898460e-01,-9.313824e-01,-9.184746e-01,-9.183467e-01,-9.274482e-01,-9.034824e-01,-9.044587e-01,-8.697664e-01,-8.689229e-01,-8.428413e-01,-8.299852e-01,-7.996402e-01,-7.846383e-01,-7.528443e-01,-7.231098e-01,-6.910453e-01,-6.671079e-01,-6.431567e-01,-6.057005e-01,-5.636007e-01,-5.404629e-01,-4.881368e-01,-4.547612e-01,-4.105607e-01,-3.753992e-01,-3.324990e-01,-2.901243e-01,-2.440242e-01,-2.023112e-01,-1.600017e-01,-1.194828e-01,-7.647838e-02,-3.323331e-02,1.022059e-02,5.133638e-02,9.590198e-02,1.296616e-01,1.607645e-01,1.995453e-01,2.504570e-01,2.701982e-01,3.296150e-01,3.642716e-01,4.109944e-01,4.355451e-01,4.981520e-01,5.160764e-01,6.496235e-01,6.437551e-01,6.594022e-01,6.941521e-01,7.213492e-01,7.552289e-01,7.936692e-01,8.160911e-01,8.231131e-01,8.707960e-01,8.871036e-01,8.869118e-01,8.950476e-01,9.031485e-01,9.344391e-01,9.181475e-01,9.124807e-01,9.399426e-01,9.166337e-01,9.083589e-01,9.052578e-01,8.899206e-01,8.770671e-01,8.907510e-01,8.639533e-01,8.359605e-01,8.057593e-01,7.863719e-01,7.679215e-01,7.421021e-01,7.035040e-01,6.711425e-01,6.444658e-01,6.204735e-01,5.817841e-01,5.489046e-01,5.106057e-01,4.689262e-01,4.312842e-01,3.953442e-01,3.474418e-01,3.115488e-01,2.661441e-01,2.189993e-01,1.794905e-01,1.384806e-01,9.336991e-02,5.275067e-02,9.183573e-03,-3.230493e-02,-7.738690e-02,-1.227706e-01,-1.626896e-01,-1.957048e-01,-2.339093e-01,-2.683862e-01,-3.082439e-01,-3.493308e-01,-4.088127e-01,-4.196507e-01,-5.168675e-01,-5.444126e-01,-5.768199e-01,-6.216563e-01,-6.474914e-01,-6.723373e-01,-7.414310e-01,-7.587587e-01,-7.784000e-01,-8.101355e-01,-8.394400e-01,-8.235540e-01,-8.853707e-01,-8.871785e-01,-9.030172e-01,-9.120448e-01,-9.044946e-01,-9.159159e-01,-9.000897e-01,-9.213488e-01,-9.269299e-01,-8.972254e-01,-8.964371e-01,-9.013951e-01,-8.991643e-01,-8.762667e-01,-8.592868e-01,-8.382165e-01,-8.236021e-01,-7.972815e-01,-7.741268e-01,-7.613123e-01,-7.266470e-01,-6.977572e-01,-6.652509e-01,-6.313400e-01,-5.982904e-01,-5.746156e-01,-5.306274e-01,-4.839907e-01,-4.514807e-01,-4.104519e-01,-3.705192e-01,-3.272053e-01,-2.827662e-01,-2.454136e-01,-1.996539e-01,-1.544120e-01,-1.127825e-01,-6.977784e-02,-2.722927e-02,1.573672e-02,5.768749e-02,9.913508e-02,1.389904e-01,1.792082e-01,2.245356e-01,2.272048e-01,2.949387e-01,3.526054e-01,3.691794e-01,4.117510e-01,4.624628e-01,5.047125e-01,5.644079e-01,5.447314e-01,6.440680e-01,6.809342e-01,7.120890e-01,7.573444e-01,7.649918e-01,8.124214e-01,8.329427e-01,8.294890e-01,8.570308e-01,8.573112e-01,8.816152e-01,9.020017e-01,9.160128e-01,9.148032e-01,9.314259e-01,9.231284e-01,9.213281e-01,9.265027e-01,9.174503e-01,9.023615e-01,8.862364e-01,8.757694e-01,8.738901e-01,8.366838e-01,8.310467e-01,7.966436e-01,7.931717e-01,7.686488e-01,7.356129e-01,7.098499e-01,6.688664e-01,6.475101e-01,6.040330e-01,5.700936e-01,5.405574e-01,5.002992e-01,4.668940e-01,4.258091e-01,3.867543e-01,3.430590e-01,3.059590e-01,2.622862e-01,2.177262e-01,1.783501e-01,1.333112e-01,9.006498e-02,4.573859e-02,5.128179e-03,-3.947949e-02,-7.846193e-02,-1.283133e-01,-1.566655e-01,-2.091626e-01,-2.522653e-01,-2.837304e-01,-3.323596e-01,-3.566015e-01,-3.995190e-01,-4.332927e-01,-4.997442e-01,-5.446948e-01,-5.785320e-01,-6.403306e-01,-6.225214e-01,-6.878301e-01,-7.411928e-01,-7.511162e-01,-7.866900e-01,-8.161565e-01,-8.322930e-01,-8.197950e-01,-8.513151e-01,-9.087380e-01,-8.778360e-01,-9.193689e-01,-9.097712e-01,-9.091885e-01,-9.085188e-01,-9.190977e-01,-8.991481e-01,-9.172244e-01,-9.017095e-01,-8.909365e-01,-8.864646e-01,-8.658706e-01,-8.541926e-01,-8.450116e-01,-8.288989e-01,-7.867701e-01,-7.776897e-01,-7.524279e-01,-7.202043e-01,-6.858191e-01,-6.668025e-01,-6.269115e-01,-5.946986e-01,-5.538857e-01,-5.272065e-01,-4.805270e-01,-4.478181e-01,-4.041860e-01,-3.673942e-01,-3.241769e-01,-2.803428e-01,-2.415864e-01,-1.943387e-01,-1.515689e-01,-1.067424e-01,-6.466489e-02,-2.221082e-02,2.131635e-02,6.487382e-02,1.039040e-01,1.435523e-01,1.864724e-01,2.241243e-01,2.724718e-01,2.968024e-01,3.456707e-01,4.051373e-01,4.334101e-01,4.642885e-01,4.963067e-01,5.604955e-01,5.668075e-01,6.352089e-01,6.544258e-01,6.921425e-01,7.318231e-01,7.596372e-01,7.701351e-01,8.363372e-01,8.276679e-01,8.783294e-01,8.924836e-01,9.002545e-01,8.829998e-01,9.019767e-01,9.123125e-01,9.269246e-01,9.363956e-01,9.191741e-01,9.307790e-01,9.152969e-01,9.136027e-01,8.932621e-01,8.756918e-01,8.562824e-01,8.511744e-01,8.343873e-01,8.080098e-01,7.807646e-01,7.589518e-01,7.264872e-01,7.024805e-01,6.730364e-01,6.463065e-01,6.108032e-01,5.774179e-01,5.379994e-01,5.043511e-01,4.636251e-01,4.251979e-01,3.792600e-01,3.401266e-01,2.981860e-01,2.585594e-01,2.163845e-01,1.661837e-01,1.242584e-01,8.166522e-02,4.064262e-02,-1.321028e-03,-4.636796e-02,-8.681058e-02,-1.278475e-01,-1.694315e-01,-2.072286e-01,-2.447403e-01,-2.787043e-01,-3.045095e-01,-3.469587e-01,-3.775334e-01,-4.553929e-01,-4.879692e-01,-5.825880e-01,-5.849966e-01,-5.963566e-01,-7.008001e-01,-7.361131e-01,-7.540798e-01,-7.446842e-01,-7.824994e-01,-7.931376e-01,-8.337548e-01,-8.164875e-01,-8.933338e-01,-8.735940e-01,-9.175961e-01,-9.017400e-01,-9.144068e-01,-9.023590e-01,-9.074691e-01,-9.129004e-01,-9.176196e-01,-9.047437e-01,-8.983823e-01,-8.957023e-01,-8.798813e-01,-8.682050e-01,-8.622629e-01,-8.325634e-01,-8.207428e-01,-8.006011e-01,-7.686964e-01,-7.505581e-01,-7.156487e-01,-6.859176e-01,-6.493037e-01,-6.243511e-01,-5.875817e-01,-5.566470e-01,-5.186286e-01,-4.784499e-01,-4.411280e-01,-4.007681e-01,-3.587723e-01,-3.169413e-01,-2.718675e-01,-2.335892e-01,-1.882815e-01,-1.486468e-01,-1.002462e-01,-5.785748e-02,-1.608937e-02,2.692572e-02,6.784202e-02,1.108610e-01,1.535643e-01,1.890776e-01,2.309966e-01,2.767372e-01,2.984730e-01,3.351129e-01,3.654169e-01,4.201824e-01,4.799295e-01,5.216182e-01,5.964193e-01,6.109202e-01,6.453980e-01,6.724624e-01,7.608176e-01,7.702749e-01,7.458150e-01,7.737716e-01,8.423278e-01,8.177239e-01,8.671255e-01,8.808670e-01,9.198794e-01,9.094442e-01,9.003242e-01,9.138186e-01,9.182871e-01,9.175523e-01,9.111852e-01,9.026437e-01,9.120567e-01,8.889504e-01,8.827389e-01,8.872235e-01,8.577054e-01,8.447211e-01,8.353229e-01,8.064270e-01,7.867871e-01,7.580090e-01,7.347470e-01,7.036399e-01,6.653075e-01,6.358851e-01,6.022587e-01,5.686601e-01,5.316334e-01,4.945449e-01,4.616173e-01,4.188603e-01,3.790318e-01,3.364883e-01,2.971565e-01,2.473383e-01,2.088473e-01,1.660047e-01,1.196777e-01,7.738190e-02,3.674473e-02,-7.552263e-03,-4.904050e-02,-8.925598e-02,-1.327894e-01,-1.746407e-01,-2.151800e-01,-2.565380e-01,-2.883361e-01,-3.252469e-01,-3.558801e-01,-4.005575e-01,-4.361128e-01,-5.362636e-01,-5.657446e-01,-6.005078e-01,-6.059289e-01,-6.446553e-01,-6.990161e-01,-7.486823e-01,-7.324626e-01,-8.068580e-01,-8.227141e-01,-8.352335e-01,-8.411280e-01,-8.611681e-01,-8.873816e-01,-8.982311e-01,-9.037709e-01,-9.086768e-01,-9.011848e-01,-9.095742e-01,-9.098191e-01,-9.061886e-01,-9.105454e-01,-8.985280e-01,-8.889346e-01,-8.736194e-01,-8.663262e-01,-8.426332e-01,-8.357549e-01,-8.128882e-01,-7.816102e-01,-7.712675e-01,-7.434226e-01,-7.096097e-01,-6.818278e-01,-6.471223e-01,-6.146575e-01,-5.832412e-01,-5.552089e-01,-5.103607e-01,-4.799566e-01,-4.357391e-01,-3.925000e-01,-3.539114e-01,-3.105901e-01,-2.666389e-01,-2.248465e-01,-1.843070e-01,-1.383436e-01,-9.561396e-02,-5.537409e-02,-1.113147e-02,3.239262e-02,7.401135e-02,1.139346e-01,1.568540e-01,1.978698e-01,2.348001e-01,2.562520e-01,3.160184e-01,3.249175e-01,3.847305e-01,4.529003e-01,4.584548e-01,5.139854e-01,6.053121e-01,6.300029e-01,6.529748e-01,6.876154e-01,7.581769e-01,7.234789e-01,8.011239e-01,8.507920e-01,8.407611e-01,8.661538e-01,8.641023e-01,8.711039e-01,9.082549e-01,9.196145e-01,9.409703e-01,9.150643e-01,9.044955e-01,9.286423e-01,9.237040e-01,9.123735e-01,8.994933e-01,9.194939e-01,8.686580e-01,8.736048e-01,8.508803e-01,8.410231e-01,8.256688e-01,8.023913e-01,7.751019e-01,7.582552e-01,7.300706e-01,7.027581e-01,6.641369e-01,6.371718e-01,5.997587e-01,5.767302e-01,5.356438e-01,4.944664e-01,4.516661e-01,4.093834e-01,3.730449e-01,3.246838e-01,2.911254e-01,2.468144e-01,2.028326e-01,1.579876e-01,1.145537e-01,7.168032e-02,2.902336e-02,-1.500134e-02,-5.581265e-02,-9.740804e-02,-1.399582e-01,-1.764750e-01,-2.167429e-01,-2.427594e-01,-2.928358e-01,-3.159554e-01,-3.779585e-01,-4.377004e-01,-4.858290e-01,-4.934069e-01,-5.662526e-01,-5.715442e-01,-6.546878e-01,-6.936344e-01,-7.025119e-01,-7.363450e-01,-7.870312e-01,-8.276688e-01,-8.285797e-01,-8.543995e-01,-8.413591e-01,-8.747191e-01,-8.869905e-01,-9.146878e-01,-8.980566e-01,-9.053715e-01,-9.177635e-01,-9.062613e-01,-9.285130e-01,-9.087425e-01,-9.067014e-01,-8.992036e-01,-8.978796e-01,-8.775520e-01,-8.704176e-01,-8.557599e-01,-8.369817e-01,-8.021349e-01,-7.929065e-01,-7.630071e-01,-7.451149e-01,-7.103890e-01,-6.947938e-01,-6.498706e-01,-6.233108e-01,-5.855905e-01,-5.456100e-01,-5.113309e-01,-4.618141e-01,-4.332767e-01,-3.911268e-01,-3.529834e-01,-3.067424e-01,-2.676979e-01,-2.209681e-01,-1.762404e-01,-1.336850e-01,-9.292676e-02,-4.949293e-02,-3.615975e-03,3.861257e-02,7.938844e-02,1.126568e-01,1.594913e-01,1.920122e-01,2.302047e-01,2.774617e-01,3.030366e-01,3.686401e-01,3.948269e-01,4.444412e-01,4.623876e-01,5.316885e-01,5.677328e-01,6.322309e-01,6.522392e-01,7.080618e-01,7.105940e-01,7.212636e-01,7.756524e-01,8.369416e-01,8.227095e-01,8.424424e-01,8.622113e-01,8.588997e-01,8.976490e-01,9.075340e-01,9.218815e-01,9.187389e-01,9.294241e-01,9.101323e-01,9.090861e-01,9.033895e-01,9.135537e-01,9.217824e-01,8.911428e-01,8.672721e-01,8.651519e-01,8.333143e-01,8.142482e-01,8.030930e-01,7.714806e-01,7.519848e-01,7.309907e-01,6.974205e-01,6.658605e-01,6.228029e-01,5.965796e-01,5.669610e-01,5.235084e-01,4.829276e-01,4.487293e-01,4.083307e-01,3.663627e-01,3.208639e-01,2.828090e-01,2.406043e-01,1.948735e-01,1.541592e-01,1.125165e-01,6.449198e-02,2.382653e-02,-1.835618e-02,-5.957943e-02,-1.005956e-01,-1.390420e-01,-1.919304e-01,-2.176796e-01,-2.446796e-01,-2.955617e-01,-3.686051e-01,-3.861862e-01,-4.579257e-01,-4.675685e-01,-5.150787e-01,-5.624430e-01,-5.884999e-01,-6.560111e-01,-6.669432e-01,-6.789816e-01,-7.629879e-01,-7.634892e-01,-7.822712e-01,-8.256520e-01,-8.279856e-01,-8.772167e-01,-8.613109e-01,-9.005914e-01,-9.200268e-01,-8.891815e-01,-9.167570e-01,-9.126536e-01,-9.261833e-01,-9.287621e-01,-9.428824e-01,-9.019340e-01,-9.047710e-01,-8.925111e-01,-8.770183e-01,-8.755265e-01,-8.515993e-01,-8.220420e-01,-8.059433e-01,-7.927275e-01,-7.726735e-01,-7.337344e-01,-7.069106e-01,-6.694694e-01,-6.405065e-01,-6.186846e-01,-5.744809e-01,-5.455381e-01,-5.050875e-01,-4.644941e-01,-4.227410e-01,-3.873137e-01,-3.452626e-01,-3.021548e-01,-2.608901e-01,-2.151198e-01,-1.732213e-01,-1.288983e-01,-8.565069e-02,-4.233324e-02,-1.795983e-03,4.136994e-02,8.441858e-02,1.306872e-01,1.675816e-01,2.013748e-01,2.455568e-01,2.722492e-01,3.163581e-01,3.648125e-01,3.693449e-01,4.368865e-01,4.733807e-01,5.013859e-01,5.874656e-01,6.089530e-01,6.899889e-01,7.051886e-01,7.439791e-01,7.384985e-01,7.580649e-01,7.765361e-01,8.208126e-01,8.939941e-01,8.649523e-01,8.919199e-01,8.845904e-01,9.015177e-01,9.288958e-01,9.219296e-01,9.046011e-01,9.118509e-01,9.176413e-01,9.089440e-01,8.992862e-01,8.993775e-01,8.959244e-01,8.706251e-01,8.559648e-01,8.258635e-01,8.160483e-01,7.903231e-01,7.704806e-01,7.480522e-01,7.286870e-01,6.973049e-01,6.589602e-01,6.247027e-01,5.931833e-01,5.582737e-01,5.247511e-01,4.857386e-01,4.380795e-01,4.045960e-01,3.626538e-01,3.173914e-01,2.738448e-01,2.376605e-01,1.902325e-01,1.486663e-01,1.055164e-01,6.426431e-02,1.829907e-02,-2.366427e-02,-6.515682e-02,-1.015207e-01,-1.479200e-01,-1.880257e-01,-2.224851e-01,-2.562200e-01,-2.897561e-01,-3.352302e-01,-4.064041e-01,-4.251206e-01,-4.738775e-01,-5.371612e-01,-5.764988e-01,-6.009295e-01,-6.593066e-01,-6.787766e-01,-6.786214e-01,-7.452232e-01,-7.310481e-01,-7.758120e-01,-8.349540e-01,-8.379017e-01,-8.750120e-01,-8.622366e-01,-9.079084e-01,-9.029967e-01,-8.976688e-01,-9.158310e-01,-9.109956e-01,-9.186796e-01,-9.254956e-01,-9.227274e-01,-9.038392e-01,-9.102946e-01,-8.828977e-01,-8.762470e-01,-8.654736e-01,-8.470035e-01,-8.299888e-01,-7.874099e-01,-7.865540e-01,-7.669336e-01,-7.199876e-01,-7.027214e-01,-6.742332e-01,-6.279354e-01,-6.074493e-01,-5.714983e-01,-5.405142e-01,-5.022732e-01,-4.637856e-01,-4.194579e-01,-3.838283e-01,-3.345419e-01,-2.988852e-01,-2.507881e-01,-2.079719e-01,-1.667798e-01,-1.249803e-01,-8.155756e-02,-3.900598e-02};

        NLMS filt1 = new NLMS(mu, leakageFactor, length, NLMS.WeightsFillMethod.ZEROS);
        filt1.filter(this.desired2, this.signal2);
        NLMS filt2 = new NLMS(mu, leakageFactor, weights);
        filt2.filter(this.desired2, this.signal2);

        Assertions.assertArrayEquals(result, filt1.getOutput(), 0.1);
        Assertions.assertArrayEquals(result, filt2.getOutput(), 0.1);
    }
}
